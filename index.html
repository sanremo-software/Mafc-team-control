<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAFC & FILHO, LDA. - Sistema de Gestão Completo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ============ RESET E VARIÁVEIS ============ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #1a5f7a;
            --secondary: #2d9cdb;
            --accent: #ff9f1c;
            --dark: #003049;
            --light: #f8f9fa;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
            --info: #17a2b8;
            --boss: #8e44ad;
            --team: #3498db;
            --purchase: #2ecc71;
            --office: #9b59b6;
            --construction: #e67e22;
            --gray: #6c757d;
            --light-gray: #e9ecef;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: var(--light);
            overflow-x: hidden;
        }

        .container {
            width: 90%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* ============ PÁGINA PÚBLICA ============ */
        #publicWebsite {
            min-height: 100vh;
        }

        .public-header {
            background: linear-gradient(135deg, var(--dark), var(--primary));
            color: white;
            padding: 1.5rem 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo i {
            font-size: 2.8rem;
            color: var(--accent);
        }

        .logo-text h1 {
            font-size: 1.8rem;
            font-weight: 800;
        }

        .logo-text span {
            color: var(--accent);
            font-size: 1rem;
            display: block;
            margin-top: 5px;
        }

        .cta-buttons {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        /* Botões */
        .btn {
            padding: 12px 30px;
            border-radius: 50px;
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            white-space: nowrap;
        }

        .btn-whatsapp {
            background: #25D366;
            color: white;
        }

        .btn-whatsapp:hover {
            background: #1da851;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(37, 211, 102, 0.4);
        }

        .btn-email {
            background: var(--accent);
            color: var(--dark);
        }

        .btn-email:hover {
            background: #ffb143;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 159, 28, 0.3);
        }

        .btn-login {
            background: var(--primary);
            color: white;
        }

        .btn-login:hover {
            background: var(--dark);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(26, 95, 122, 0.3);
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(rgba(0, 48, 73, 0.88), rgba(0, 48, 73, 0.92)), 
                        url('https://images.unsplash.com/photo-1504307651254-35680f356dfd?ixlib=rb-4.0.3&auto=format&fit=crop&w=1800&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: white;
            padding: 180px 0 120px;
            text-align: center;
            margin-top: 80px;
        }

        .hero h2 {
            font-size: 3.8rem;
            margin-bottom: 25px;
            font-weight: 900;
            text-transform: uppercase;
            text-shadow: 3px 3px 8px rgba(0,0,0,0.4);
            line-height: 1.2;
        }

        .hero p {
            font-size: 1.4rem;
            max-width: 850px;
            margin: 0 auto 50px;
            opacity: 0.95;
            line-height: 1.8;
        }

        .hero-buttons {
            display: flex;
            gap: 25px;
            justify-content: center;
            margin-top: 40px;
            flex-wrap: wrap;
        }

        /* ============ MODAL LOGIN ============ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            width: 90%;
            max-width: 500px;
            border-radius: 20px;
            overflow: hidden;
            animation: modalSlideIn 0.4s;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
        }

        @keyframes modalSlideIn {
            from { transform: translateY(-50px) scale(0.9); opacity: 0; }
            to { transform: translateY(0) scale(1); opacity: 1; }
        }

        .modal-header {
            background: linear-gradient(135deg, var(--dark), var(--primary));
            color: white;
            padding: 25px;
            text-align: center;
            position: relative;
        }

        .modal-header h2 {
            font-size: 2rem;
            font-weight: 700;
        }

        .close-modal {
            position: absolute;
            top: 20px;
            right: 25px;
            font-size: 1.8rem;
            cursor: pointer;
            color: white;
            transition: color 0.3s;
        }

        .close-modal:hover {
            color: var(--accent);
        }

        .modal-body {
            padding: 50px;
        }

        .form-group {
            margin-bottom: 30px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            color: var(--dark);
            font-weight: 600;
            font-size: 1.1rem;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1.1rem;
            transition: all 0.3s;
            background: #f8f9fa;
        }

        .form-group input:focus, .form-group select:focus {
            border-color: var(--primary);
            outline: none;
            background: white;
            box-shadow: 0 0 0 3px rgba(26, 95, 122, 0.1);
        }

        .login-submit {
            background: linear-gradient(135deg, var(--primary), var(--dark));
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .login-submit:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(26, 95, 122, 0.3);
            background: linear-gradient(135deg, var(--dark), var(--primary));
        }

        /* ============ DASHBOARDS ============ */
        .dashboard {
            display: none;
            min-height: 100vh;
            background: #f0f2f5;
        }

        /* Top Bar Horizontal */
        .top-bar {
            background: white;
            padding: 0;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            border-bottom: 5px solid;
        }

        /* Cores diferentes para cada dashboard */
        .boss-dashboard .top-bar {
            border-bottom-color: var(--boss);
            background: linear-gradient(135deg, #9b59b6, var(--boss));
        }

        .team-dashboard .top-bar {
            border-bottom-color: var(--team);
            background: linear-gradient(135deg, #3498db, #2980b9);
        }

        .purchase-dashboard .top-bar {
            border-bottom-color: var(--purchase);
            background: linear-gradient(135deg, #2ecc71, #27ae60);
        }

        .office-dashboard .top-bar {
            border-bottom-color: var(--office);
            background: linear-gradient(135deg, var(--office), #8e44ad);
        }

        .top-bar-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .dashboard-brand {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .dashboard-brand i {
            font-size: 2.2rem;
            color: white;
        }

        .dashboard-brand h1 {
            color: white;
            font-size: 1.8rem;
            font-weight: 700;
        }

        .dashboard-info {
            display: flex;
            align-items: center;
            gap: 25px;
            color: white;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(255,255,255,0.15);
            padding: 10px 20px;
            border-radius: 50px;
            backdrop-filter: blur(10px);
        }

        .user-info i {
            font-size: 1.4rem;
        }

        .logout-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            padding: 10px 25px;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            backdrop-filter: blur(10px);
        }

        .logout-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
            border-color: white;
        }

        /* Menu Horizontal FIXO NO TOPO */
        .horizontal-menu {
            background: white;
            margin-top: 70px;
            padding: 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            position: fixed;
            width: 100%;
            z-index: 999;
            overflow-x: auto;
        }

        .menu-container {
            display: flex;
            gap: 5px;
            padding: 0;
            width: 100%;
        }

        .menu-item {
            padding: 20px 30px;
            color: #555;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: 600;
            white-space: nowrap;
            border-bottom: 4px solid transparent;
            transition: all 0.3s;
            position: relative;
        }

        .menu-item:hover {
            color: var(--primary);
            background: #f8f9fa;
        }

        .menu-item.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background: #f0f7ff;
        }

        .menu-item i {
            font-size: 1.2rem;
        }

        .menu-badge {
            background: var(--accent);
            color: white;
            font-size: 0.75rem;
            padding: 3px 8px;
            border-radius: 20px;
            margin-left: 8px;
            font-weight: 700;
        }

        /* Conteúdo do Dashboard - AFASTADO DO MENU FIXO */
        .dashboard-content {
            margin-top: 140px;
            padding: 20px 30px 80px 30px;
            background: #f0f2f5;
            min-height: calc(100vh - 140px);
        }

        /* MENU NO FUNDO */
        .bottom-menu {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
            z-index: 1000;
            overflow-x: auto;
        }

        .bottom-menu-container {
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
        }

        .bottom-menu-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px 15px;
            color: #666;
            text-decoration: none;
            font-size: 0.85rem;
            text-align: center;
            min-width: 80px;
            border-radius: 10px;
            transition: all 0.3s;
        }

        .bottom-menu-item:hover {
            background: #f8f9fa;
            color: var(--primary);
        }

        .bottom-menu-item.active {
            color: var(--primary);
            background: #f0f7ff;
        }

        .bottom-menu-item i {
            font-size: 1.4rem;
            margin-bottom: 5px;
        }

        .bottom-menu-badge {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--accent);
            color: white;
            font-size: 0.7rem;
            padding: 2px 5px;
            border-radius: 50%;
            min-width: 18px;
            text-align: center;
        }

        /* Dashboard Sections */
        .dashboard-section {
            display: none;
        }

        .dashboard-section.active {
            display: block;
        }

        /* Cards de Estatísticas */
        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .stat-card-horizontal {
            background: white;
            padding: 25px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            gap: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            border-left: 6px solid;
            transition: transform 0.3s;
        }

        .stat-card-horizontal:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.12);
        }

        .boss-dashboard .stat-card-horizontal { border-left-color: var(--boss); }
        .team-dashboard .stat-card-horizontal { border-left-color: var(--team); }
        .purchase-dashboard .stat-card-horizontal { border-left-color: var(--purchase); }
        .office-dashboard .stat-card-horizontal { border-left-color: var(--office); }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
        }

        .boss-dashboard .stat-icon { background: linear-gradient(135deg, var(--boss), #9b59b6); }
        .team-dashboard .stat-icon { background: linear-gradient(135deg, var(--team), #3498db); }
        .purchase-dashboard .stat-icon { background: linear-gradient(135deg, var(--purchase), #2ecc71); }
        .office-dashboard .stat-icon { background: linear-gradient(135deg, var(--office), #9b59b6); }

        .stat-info h3 {
            font-size: 2.2rem;
            color: var(--dark);
            margin-bottom: 5px;
            font-weight: 800;
        }

        .stat-info p {
            color: #666;
            font-weight: 600;
            font-size: 1rem;
        }

        /* Grids de Conteúdo */
        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        /* Cards de Conteúdo */
        .content-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            transition: transform 0.3s;
        }

        .content-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.12);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .card-header h3 {
            color: var(--dark);
            font-size: 1.4rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .card-header h3 i {
            color: var(--primary);
        }

        /* Botões Dashboard */
        .btn-dashboard {
            padding: 12px 25px;
            border-radius: 10px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
            font-size: 1rem;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--dark);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(26, 95, 122, 0.3);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #219653;
            transform: translateY(-3px);
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-warning:hover {
            background: #e67e22;
            transform: translateY(-3px);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #c0392b;
            transform: translateY(-3px);
        }

        .btn-info {
            background: var(--info);
            color: white;
        }

        .btn-info:hover {
            background: #138496;
            transform: translateY(-3px);
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 0.85rem;
        }

        /* Tabelas */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .data-table th {
            background: var(--primary);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            font-size: 1rem;
        }

        .data-table td {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        .data-table tr:hover {
            background: #f8f9fa;
        }

        /* Badges */
        .badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            display: inline-block;
        }

        .badge-success { background: #d5f4e6; color: var(--success); }
        .badge-warning { background: #fff3cd; color: var(--warning); }
        .badge-danger { background: #f8d7da; color: var(--danger); }
        .badge-primary { background: #d1ecf1; color: var(--secondary); }
        .badge-info { background: #d1ecf1; color: #17a2b8; }
        .badge-secondary { background: #e2e3e5; color: #6c757d; }

        /* Formulários */
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group-dashboard {
            margin-bottom: 20px;
        }

        .form-group-dashboard label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark);
            font-weight: 600;
            font-size: 1rem;
        }

        .form-group-dashboard input,
        .form-group-dashboard select,
        .form-group-dashboard textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
            background: #f8f9fa;
        }

        .form-group-dashboard input:focus,
        .form-group-dashboard select:focus,
        .form-group-dashboard textarea:focus {
            border-color: var(--primary);
            outline: none;
            background: white;
            box-shadow: 0 0 0 3px rgba(26, 95, 122, 0.1);
        }

        .form-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #f0f0f0;
        }

        /* Time Tracker */
        .time-tracker {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
        }

        .time-display {
            font-size: 3.5rem;
            font-weight: 800;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .time-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* Sistema de Alertas */
        .alert {
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border-left: 5px solid var(--success);
        }

        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border-left: 5px solid var(--warning);
        }

        .alert-danger {
            background: #f8d7da;
            color: #721c24;
            border-left: 5px solid var(--danger);
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border-left: 5px solid var(--info);
        }

        /* Sistema de Filtros */
        .filter-bar {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* GPS Tracker */
        .gps-tracker {
            background: linear-gradient(135deg, #11998e, #38ef7d);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
        }

        .gps-info {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .gps-coordinates {
            font-family: monospace;
            font-size: 1.2rem;
            background: rgba(255,255,255,0.15);
            padding: 12px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        /* Extrato Mensal */
        .monthly-report {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #eee;
        }

        .report-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        /* Tabela de Horários */
        .time-sheet-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .time-sheet-table th {
            background: #f8f9fa;
            padding: 12px;
            text-align: left;
            border-bottom: 2px solid #ddd;
        }

        .time-sheet-table td {
            padding: 12px;
            border-bottom: 1px solid #eee;
        }

        /* ============ MODAIS ============ */
        .modal-employee, .modal-monthly-report, .modal-document, .modal-purchase-details, .modal-team, .modal-gps {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            z-index: 2001;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .modal-employee-content, .modal-monthly-report-content, 
        .modal-document-content, .modal-purchase-details-content,
        .modal-team-content, .modal-gps-content {
            background: white;
            width: 90%;
            max-width: 800px;
            border-radius: 15px;
            padding: 30px;
            position: relative;
            max-height: 85vh;
            overflow-y: auto;
        }

        .close-modal-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--dark);
            background: none;
            border: none;
        }

        .close-modal-btn:hover {
            color: var(--danger);
        }

        /* Responsividade */
        @media (max-width: 1200px) {
            .content-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 992px) {
            .hero h2 {
                font-size: 2.8rem;
            }
            
            .section-title {
                font-size: 2.3rem;
            }
            
            .menu-container {
                overflow-x: auto;
                padding-bottom: 10px;
            }
            
            .menu-item {
                padding: 15px 20px;
                font-size: 0.95rem;
            }
            
            .dashboard-content {
                padding: 15px;
            }
            
            .bottom-menu-item {
                padding: 8px 10px;
                font-size: 0.8rem;
                min-width: 70px;
            }
        }

        @media (max-width: 768px) {
            .hero {
                padding: 150px 0 80px;
            }
            
            .hero h2 {
                font-size: 2.2rem;
            }
            
            .hero p {
                font-size: 1.2rem;
            }
            
            .stats-row {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .top-bar-content {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .dashboard-info {
                flex-direction: column;
                gap: 15px;
            }
            
            .menu-item {
                padding: 12px 15px;
            }
            
            .content-card {
                padding: 20px;
            }
            
            .time-display {
                font-size: 2.8rem;
            }
        }

        @media (max-width: 480px) {
            .hero h2 {
                font-size: 1.8rem;
            }
            
            .section-title {
                font-size: 1.8rem;
            }
            
            .btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
            
            .dashboard-content {
                padding: 10px;
            }
            
            .modal-employee-content,
            .modal-monthly-report-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- ============ PÁGINA PÚBLICA ============ -->
    <div id="publicWebsite">
        <!-- Header Público -->
        <header class="public-header">
            <div class="container nav-container">
                <div class="logo">
                    <i class="fas fa-hard-hat"></i>
                    <div class="logo-text">
                        <h1>MAFC & FILHO, LDA.</h1>
                        <span>Construção Civil & Obras Públicas | Desde 2001</span>
                    </div>
                </div>
                <div class="cta-buttons">
                    <a href="https://wa.me/351123456789?text=Olá MAFC,%20gostaria%20de%20solicitar%20um%20orçamento%20para%20uma%20obra" 
                       class="btn btn-whatsapp" target="_blank">
                        <i class="fab fa-whatsapp"></i> WhatsApp
                    </a>
                    <a href="mailto:orcamentos@mafc-filho.pt?subject=Solicitação de Orçamento&body=Olá MAFC,%0D%0A%0D%0AGostaria de solicitar um orçamento para:" 
                       class="btn btn-email">
                        <i class="fas fa-envelope"></i> Pedir Orçamento
                    </a>
                    <a href="#" class="btn btn-login" id="openLogin">
                        <i class="fas fa-sign-in-alt"></i> Acesso Sistema
                    </a>
                </div>
            </div>
        </header>

        <!-- Hero Section -->
        <section class="hero">
            <div class="container">
                <h2>Especialistas em Construção Civil e Obras Públicas</h2>
                <p>Mais de 20 anos de experiência em saneamento, abastecimento de água, redes de fibra óptica, pavimentação e infraestruturas. Operação em Portugal e Alemanha com 15 equipas especializadas.</p>
                <div class="hero-buttons">
                    <a href="#gallery" class="btn btn-email">
                        <i class="fas fa-hard-hat"></i> Ver Projetos
                    </a>
                    <a href="mailto:orcamentos@mafc-filho.pt" class="btn btn-whatsapp">
                        <i class="fas fa-calculator"></i> Orçamento Grátis
                    </a>
                </div>
            </div>
        </section>

        <!-- Galeria de Projetos -->
        <section class="gallery" id="gallery">
            <div class="container">
                <h2 class="section-title">Nossos Projetos</h2>
                <div class="gallery-grid">
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1541888946425-d81bb19240f5?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" alt="Saneamento">
                        <div class="gallery-overlay">
                            <h3>Sistema de Saneamento</h3>
                            <p>Rede de águas pluviais em Berlim</p>
                        </div>
                    </div>
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1504917595217-d4dc5ebe6122?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" alt="Fibra Óptica">
                        <div class="gallery-overlay">
                            <h3>Redes de Fibra Óptica</h3>
                            <p>Infraestrutura de telecomunicações</p>
                        </div>
                    </div>
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1519501025264-65ba15a82390?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" alt="Pavimentação">
                        <div class="gallery-overlay">
                            <h3>Pavimentação Urbana</h3>
                            <p>Reabilitação de vias públicas</p>
                        </div>
                    </div>
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1541625602330-2277a4c46182?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" alt="Infraestruturas">
                        <div class="gallery-overlay">
                            <h3>Infraestruturas EDP</h3>
                            <p>Instalação elétrica e gás natural</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="public-footer" style="background: var(--dark); color: white; padding: 80px 0 40px;">
            <div class="container">
                <div class="footer-content">
                    <div>
                        <h3>MAFC & FILHO, LDA.</h3>
                        <p>Constituída em 2001, somos especialistas em construção civil e obras públicas com operação em Portugal e Alemanha.</p>
                    </div>
                </div>
                <div class="copyright">
                    <p>&copy; 2001-2024 MAFC & FILHO, LDA. - Todos os direitos reservados.</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- ============ MODAL DE LOGIN ============ -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-lock"></i> Acesso ao Sistema MAFC</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="loginForm">
                    <div class="form-group">
                        <label for="username"><i class="fas fa-user"></i> Código de Acesso</label>
                        <input type="text" id="username" placeholder="Digite seu código" required>
                    </div>
                    <div class="form-group">
                        <label for="password"><i class="fas fa-key"></i> Senha</label>
                        <input type="password" id="password" placeholder="Digite sua senha" required>
                    </div>
                    <div class="form-group">
                        <label for="role"><i class="fas fa-user-tag"></i> Tipo de Acesso</label>
                        <select id="role" required>
                            <option value="">Selecione o tipo de acesso</option>
                            <option value="boss">Administração Geral</option>
                            <option value="team">Chefe de Equipa</option>
                            <option value="purchase">Responsável de Compras</option>
                            <option value="office">Escritório</option>
                        </select>
                    </div>
                    <button type="submit" class="login-submit">
                        <i class="fas fa-sign-in-alt"></i> Entrar no Sistema
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- ============ DASHBOARD DO PATRÃO/ADMIN ============ -->
    <div class="dashboard boss-dashboard" id="bossDashboard">
        <!-- Top Bar -->
        <div class="top-bar">
            <div class="container top-bar-content">
                <div class="dashboard-brand">
                    <i class="fas fa-crown"></i>
                    <h1>Painel Administrativo - MAFC</h1>
                </div>
                <div class="dashboard-info">
                    <div class="user-info">
                        <i class="fas fa-user-circle"></i>
                        <span id="bossUserName">Administrador</span>
                    </div>
                    <div id="bossCurrentTime" style="font-weight: 600;">10:45 AM</div>
                    <button class="logout-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Sair
                    </button>
                </div>
            </div>
        </div>

        <!-- Conteúdo -->
        <div class="dashboard-content">
            <!-- Visão Geral -->
            <div class="dashboard-section active" id="bossOverviewSection">
                <div class="stats-row">
                    <div class="stat-card-horizontal">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="totalEmployees">0</h3>
                            <p>Total Colaboradores</p>
                        </div>
                    </div>
                    <div class="stat-card-horizontal">
                        <div class="stat-icon">
                            <i class="fas fa-hard-hat"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="activeTeams">0</h3>
                            <p>Equipas Ativas</p>
                        </div>
                    </div>
                    <div class="stat-card-horizontal">
                        <div class="stat-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="todayHours">0</h3>
                            <p>Horas Hoje</p>
                        </div>
                    </div>
                    <div class="stat-card-horizontal">
                        <div class="stat-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="pendingItems">0</h3>
                            <p>Pendentes</p>
                        </div>
                    </div>
                </div>

                <div class="content-grid">
                    <!-- Alertas Recentes -->
                    <div class="content-card">
                        <div class="card-header">
                            <h3><i class="fas fa-bell"></i> Alertas Recentes</h3>
                            <button class="btn-dashboard btn-primary" onclick="markAllAlertsRead()">
                                <i class="fas fa-check-double"></i> Marcar Lidas
                            </button>
                        </div>
                        <div id="bossAlerts">
                            <!-- Alertas serão carregados aqui -->
                        </div>
                    </div>

                    <!-- Atividade Recente -->
                    <div class="content-card">
                        <div class="card-header">
                            <h3><i class="fas fa-history"></i> Atividade do Sistema</h3>
                            <button class="btn-dashboard btn-info" onclick="refreshActivity()">
                                <i class="fas fa-sync-alt"></i> Atualizar
                            </button>
                        </div>
                        <div style="max-height: 300px; overflow-y: auto;">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Data/Hora</th>
                                        <th>Utilizador</th>
                                        <th>Ação</th>
                                        <th>Detalhes</th>
                                    </tr>
                                </thead>
                                <tbody id="bossActivityLog">
                                    <!-- Log de atividades será carregado aqui -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Controlo Total de Horas -->
            <div class="dashboard-section" id="bossHoursSection">
                <div class="content-card">
                    <div class="card-header">
                        <h3><i class="fas fa-clock"></i> Controlo Total de Horas</h3>
                        <button class="btn-dashboard btn-success" onclick="printAllTimeReport()">
                            <i class="fas fa-print"></i> Imprimir Tudo
                        </button>
                    </div>

                    <div class="filter-bar">
                        <input type="date" id="bossHoursDate" value="<?php echo date('Y-m-d'); ?>" onchange="loadAllTimeRecords()">
                        <select id="bossFilterDept" onchange="loadAllTimeRecords()">
                            <option value="all">Todos Departamentos</option>
                            <option value="office">Escritório</option>
                            <option value="construction">Obra</option>
                            <option value="purchase">Compras</option>
                        </select>
                        <button class="btn-dashboard btn-primary" onclick="loadAllTimeRecords()">
                            <i class="fas fa-sync-alt"></i> Atualizar
                        </button>
                    </div>

                    <div style="max-height: 500px; overflow-y: auto;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>Departamento</th>
                                    <th>Equipa</th>
                                    <th>Entrada</th>
                                    <th>Saída</th>
                                    <th>Total</th>
                                    <th>Estado</th>
                                    <th>GPS</th>
                                </tr>
                            </thead>
                            <tbody id="bossAllTimeRecords">
                                <!-- Todos os registos de horas serão carregados aqui -->
                            </tbody>
                        </table>
                    </div>

                    <div class="form-actions">
                        <button class="btn-dashboard btn-danger" onclick="clearAllTimeRecords()">
                            <i class="fas fa-trash"></i> Limpar Histórico Completo
                        </button>
                        <button class="btn-dashboard btn-info" onclick="exportAllTimeData()">
                            <i class="fas fa-file-excel"></i> Exportar Excel
                        </button>
                        <button class="btn-dashboard btn-primary" onclick="printAccountingReport()">
                            <i class="fas fa-print"></i> Para Contabilidade
                        </button>
                    </div>
                </div>
            </div>

            <!-- Controlo de GPS das Equipas -->
            <div class="dashboard-section" id="bossGPSSection">
                <div class="content-card">
                    <div class="card-header">
                        <h3><i class="fas fa-map-marker-alt"></i> GPS das Equipas em Tempo Real</h3>
                        <button class="btn-dashboard btn-success" onclick="refreshAllGPS()">
                            <i class="fas fa-sync-alt"></i> Atualizar GPS
                        </button>
                    </div>

                    <div class="gps-tracker">
                        <div class="gps-info">
                            <i class="fas fa-satellite" style="font-size: 2rem;"></i>
                            <div>
                                <h4 style="margin: 0;">Monitorização GPS em Tempo Real</h4>
                                <p>Localização atual de todas as equipas</p>
                            </div>
                        </div>
                        
                        <div id="bossGPSMap" style="height: 300px; background: rgba(255,255,255,0.1); border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px;">
                            <div style="text-align: center; color: white;">
                                <i class="fas fa-map" style="font-size: 4rem; margin-bottom: 10px;"></i>
                                <p>Mapa de localização das equipas</p>
                            </div>
                        </div>

                        <div class="time-buttons">
                            <button class="btn-dashboard btn-success" onclick="requestAllGPS()">
                                <i class="fas fa-satellite-dish"></i> Pedir GPS a Todas
                            </button>
                            <button class="btn-dashboard btn-warning" onclick="viewGPSHistory()">
                                <i class="fas fa-history"></i> Histórico GPS
                            </button>
                        </div>
                    </div>

                    <div style="margin-top: 20px;">
                        <h4><i class="fas fa-users"></i> Localização das Equipas</h4>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Equipa</th>
                                    <th>Localização</th>
                                    <th>Última Atualização</th>
                                    <th>Coordenadas GPS</th>
                                    <th>WhatsApp Equipa</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="bossTeamsGPS">
                                <!-- GPS das equipas será carregado aqui -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Gestão Completa de Pessoal -->
            <div class="dashboard-section" id="bossPeopleSection">
                <div class="content-card">
                    <div class="card-header">
                        <h3><i class="fas fa-user-plus"></i> Gestão Completa de Pessoal</h3>
                        <button class="btn-dashboard btn-success" onclick="openEmployeeModal('boss')">
                            <i class="fas fa-plus"></i> Adicionar Pessoa
                        </button>
                    </div>

                    <div class="filter-bar">
                        <input type="text" id="bossSearchPerson" placeholder="Pesquisar nome..." onkeyup="searchBossPeople()">
                        <select id="bossFilterDept" onchange="searchBossPeople()">
                            <option value="all">Todos Departamentos</option>
                            <option value="office">Escritório</option>
                            <option value="construction">Obra</option>
                            <option value="purchase">Compras</option>
                        </select>
                        <select id="bossFilterStatus" onchange="searchBossPeople()">
                            <option value="all">Todos Estados</option>
                            <option value="active">Ativos</option>
                            <option value="inactive">Inativos</option>
                        </select>
                    </div>

                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>WhatsApp</th>
                                <th>Cargo</th>
                                <th>Departamento</th>
                                <th>Equipa</th>
                                <th>Estado</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="bossPeopleTable">
                            <!-- Pessoal será carregado aqui -->
                        </tbody>
                    </table>

                    <div class="form-actions">
                        <button class="btn-dashboard btn-danger" onclick="deleteAllInactive()">
                            <i class="fas fa-trash"></i> Remover Todos Inativos
                        </button>
                        <button class="btn-dashboard btn-warning" onclick="exportPeopleList()">
                            <i class="fas fa-file-excel"></i> Exportar Lista
                        </button>
                    </div>
                </div>
            </div>

            <!-- Auditoria Completa -->
            <div class="dashboard-section" id="bossAuditSection">
                <div class="content-card">
                    <div class="card-header">
                        <h3><i class="fas fa-shield-alt"></i> Auditoria Completa do Sistema</h3>
                        <button class="btn-dashboard btn-danger" onclick="clearAuditLog()">
                            <i class="fas fa-trash"></i> Limpar Log Completo
                        </button>
                    </div>

                    <div class="filter-bar">
                        <input type="date" id="auditDateFrom" value="<?php echo date('Y-m-d'); ?>">
                        <input type="date" id="auditDateTo" value="<?php echo date('Y-m-d'); ?>">
                        <select id="auditUserFilter" onchange="filterAudit()">
                            <option value="all">Todos Utilizadores</option>
                        </select>
                        <button class="btn-dashboard btn-primary" onclick="filterAudit()">
                            <i class="fas fa-filter"></i> Filtrar
                        </button>
                    </div>

                    <div style="max-height: 500px; overflow-y: auto;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Data/Hora</th>
                                    <th>Utilizador</th>
                                    <th>Tipo</th>
                                    <th>Ação</th>
                                    <th>Detalhes</th>
                                    <th>IP</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="bossAuditTable">
                                <!-- Log de auditoria será carregado aqui -->
                            </tbody>
                        </table>
                    </div>

                    <div class="form-actions">
                        <button class="btn-dashboard btn-danger" onclick="clearSelectedAudit()">
                            <i class="fas fa-trash"></i> Limpar Selecionados
                        </button>
                        <button class="btn-dashboard btn-info" onclick="exportAuditLog()">
                            <i class="fas fa-file-excel"></i> Exportar Log
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- MENU NO FUNDO PARA PATRÃO -->
        <nav class="bottom-menu">
            <div class="bottom-menu-container">
                <a href="#" class="bottom-menu-item active" data-section="bossOverview">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Visão Geral</span>
                </a>
                <a href="#" class="bottom-menu-item" data-section="bossHours">
                    <i class="fas fa-clock"></i>
                    <span>Controlo Horas</span>
                </a>
                <a href="#" class="bottom-menu-item" data-section="bossGPS">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>GPS Equipas</span>
                </a>
                <a href="#" class="bottom-menu-item" data-section="bossPeople">
                    <i class="fas fa-users"></i>
                    <span>Pessoal</span>
                </a>
                <a href="#" class="bottom-menu-item" data-section="bossAudit">
                    <i class="fas fa-shield-alt"></i>
                    <span>Auditoria</span>
                </a>
            </div>
        </nav>
    </div>

    <!-- ============ DASHBOARD ESCRITÓRIO ============ -->
    <div class="dashboard office-dashboard" id="officeDashboard">
        <!-- Top Bar -->
        <div class="top-bar">
            <div class="container top-bar-content">
                <div class="dashboard-brand">
                    <i class="fas fa-building"></i>
                    <h1>Escritório - MAFC</h1>
                </div>
                <div class="dashboard-info">
                    <div class="user-info">
                        <i class="fas fa-user-tie"></i>
                        <span id="officeUserName">Escritório</span>
                    </div>
                    <div id="officeCurrentTime" style="font-weight: 600;">10:45 AM</div>
                    <button class="logout-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Sair
                    </button>
                </div>
            </div>
        </div>

        <!-- Conteúdo -->
        <div class="dashboard-content">
            <!-- Marcação Obrigatória de Horas -->
            <div class="dashboard-section active" id="officeTimeSection">
                <div class="content-card">
                    <div class="card-header">
                        <h3><i class="fas fa-clock"></i> Marcação Obrigatória de Horas</h3>
                        <div class="time-display" style="font-size: 2.5rem; color: var(--office);" id="officeClock">
                            08:45:23
                        </div>
                    </div>

                    <div class="time-tracker">
                        <div class="time-buttons">
                            <button class="btn-dashboard btn-success" onclick="markOfficeTime('entry')">
                                <i class="fas fa-sign-in-alt"></i> ENTRADA OBRIGATÓRIA
                            </button>
                            <button class="btn-dashboard btn-warning" onclick="markOfficeTime('break_start')">
                                <i class="fas fa-coffee"></i> INÍCIO PAUSA
                            </button>
                            <button class="btn-dashboard btn-danger" onclick="markOfficeTime('exit')">
                                <i class="fas fa-sign-out-alt"></i> SAÍDA OBRIGATÓRIA
                            </button>
                        </div>
                    </div>

                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i>
                        <div>
                            <strong>Atenção:</strong> A marcação de horas é obrigatória. O patrão monitoriza todas as marcações.
                        </div>
                    </div>

                    <div style="margin-top: 20px;">
                        <h4><i class="fas fa-history"></i> Minhas Marcações Hoje</h4>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Data</th>
                                    <th>Entrada</th>
                                    <th>Início Pausa</th>
                                    <th>Fim Pausa</th>
                                    <th>Saída</th>
                                    <th>Total Horas</th>
                                    <th>Estado</th>
                                </tr>
                            </thead>
                            <tbody id="officeMyTime">
                                <!-- Marcações do usuário serão carregadas aqui -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Gestão de Pessoal do Escritório -->
            <div class="dashboard-section" id="officePeopleSection">
                <div class="content-card">
                    <div class="card-header">
                        <h3><i class="fas fa-user-plus"></i> Gestão de Pessoal do Escritório</h3>
                        <button class="btn-dashboard btn-success" onclick="openEmployeeModal('office')">
                            <i class="fas fa-plus"></i> Adicionar Pessoa
                        </button>
                    </div>

                    <div class="filter-bar">
                        <input type="text" id="officeSearchPerson" placeholder="Pesquisar nome..." onkeyup="searchOfficePeople()">
                        <select id="officeFilterStatus" onchange="searchOfficePeople()">
                            <option value="all">Todos Estados</option>
                            <option value="active">Ativos</option>
                            <option value="inactive">Inativos</option>
                        </select>
                    </div>

                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Cargo</th>
                                <th>Entrada Hoje</th>
                                <th>Saída Hoje</th>
                                <th>Total Hoje</th>
                                <th>Estado</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="officePeopleTable">
                            <!-- Pessoal será carregado aqui -->
                        </tbody>
                    </table>

                    <div class="form-actions">
                        <button class="btn-dashboard btn-primary" onclick="printOfficeAccountingReport()">
                            <i class="fas fa-print"></i> Imprimir para Contabilidade
                        </button>
                        <button class="btn-dashboard btn-danger" onclick="deleteInactiveOfficePeople()">
                            <i class="fas fa-trash"></i> Remover Inativos
                        </button>
                    </div>
                </div>
            </div>

            <!-- Meu Extrato Mensal -->
            <div class="dashboard-section" id="officeReportsSection">
                <div class="content-card">
                    <div class="card-header">
                        <h3><i class="fas fa-file-invoice"></i> Meu Extrato Mensal</h3>
                        <button class="btn-dashboard btn-success" onclick="generateMyMonthlyReport()">
                            <i class="fas fa-sync-alt"></i> Gerar Extrato
                        </button>
                    </div>

                    <div class="form-row">
                        <div class="form-group-dashboard">
                            <label>Mês/Ano</label>
                            <select id="officeReportMonth">
                                <option value="<?php echo date('m-Y'); ?>"><?php echo date('F Y'); ?></option>
                                <?php for($i=1; $i<=12; $i++): ?>
                                    <?php $date = date('m-Y', strtotime("-$i months")); ?>
                                    <option value="<?php echo $date; ?>"><?php echo date('F Y', strtotime("-$i months")); ?></option>
                                <?php endfor; ?>
                            </select>
                        </div>
                    </div>

                    <div class="monthly-report">
                        <div class="report-header">
                            <h4 id="officeReportTitle">Selecione o mês</h4>
                            <span class="badge badge-info" id="officeTotalHours">-- horas</span>
                        </div>
                        
                        <table class="time-sheet-table" id="officeTimeSheet">
                            <thead>
                                <tr>
                                    <th>Data</th>
                                    <th>Entrada</th>
                                    <th>Saída</th>
                                    <th>Horas Normais</th>
                                    <th>Horas Extra</th>
                                    <th>Total</th>
                                </tr>
                            </thead>
                            <tbody id="officeReportBody">
                                <!-- Dados do extrato serão carregados aqui -->
                            </tbody>
                        </table>
                        
                        <div class="report-actions">
                            <button class="btn-dashboard btn-primary" onclick="printMyAccountingReport()">
                                <i class="fas fa-print"></i> IMPRIMIR para Contabilidade
                            </button>
                            <button class="btn-dashboard btn-whatsapp" onclick="sendMyReportWhatsApp()">
                                <i class="fab fa-whatsapp"></i> WhatsApp (Opcional)
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- MENU NO FUNDO PARA ESCRITÓRIO -->
        <nav class="bottom-menu">
            <div class="bottom-menu-container">
                <a href="#" class="bottom-menu-item active" data-section="officeTime">
                    <i class="fas fa-clock"></i>
                    <span>Marcar Horas</span>
                </a>
                <a href="#" class="bottom-menu-item" data-section="officePeople">
                    <i class="fas fa-user-plus"></i>
                    <span>Pessoal</span>
                </a>
                <a href="#" class="bottom-menu-item" data-section="officeReports">
                    <i class="fas fa-file-alt"></i>
                    <span>Meu Extrato</span>
                </a>
            </div>
        </nav>
    </div>

    <!-- ============ DASHBOARD CHEFE DE EQUIPA ============ -->
    <div class="dashboard team-dashboard" id="teamDashboard">
        <!-- Top Bar -->
        <div class="top-bar">
            <div class="container top-bar-content">
                <div class="dashboard-brand">
                    <i class="fas fa-hard-hat"></i>
                    <h1>Chefe de Equipa - MAFC</h1>
                </div>
                <div class="dashboard-info">
                    <div class="user-info">
                        <i class="fas fa-user-hard-hat"></i>
                        <span id="teamUserName">Equipa</span>
                    </div>
                    <div id="teamCurrentTime" style="font-weight: 600;">10:45 AM</div>
                    <button class="logout-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Sair
                    </button>
                </div>
            </div>
        </div>

        <!-- Conteúdo -->
        <div class="dashboard-content">
            <!-- Marcação Obrigatória de Horas -->
            <div class="dashboard-section active" id="teamTimeSection">
                <div class="content-card">
                    <div class="card-header">
                        <h3><i class="fas fa-clock"></i> Marcação Obrigatória de Horas</h3>
                        <div class="time-display" style="font-size: 2.5rem; color: var(--team);" id="teamClock">
                            08:45:23
                        </div>
                    </div>

                    <div class="time-tracker">
                        <div class="time-buttons">
                            <button class="btn-dashboard btn-success" onclick="markTeamTime('entry')">
                                <i class="fas fa-sign-in-alt"></i> ENTRADA OBRIGATÓRIA
                            </button>
                            <button class="btn-dashboard btn-warning" onclick="markTeamTime('break_start')">
                                <i class="fas fa-coffee"></i> INÍCIO PAUSA
                            </button>
                            <button class="btn-dashboard btn-danger" onclick="markTeamTime('exit')">
                                <i class="fas fa-sign-out-alt"></i> SAÍDA OBRIGATÓRIA
                            </button>
                        </div>
                    </div>

                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle"></i>
                        <div>
                            <strong>Obrigatório:</strong> O patrão monitoriza todas as marcações. Marque sempre entrada e saída.
                        </div>
                    </div>

                    <div style="margin-top: 20px;">
                        <h4><i class="fas fa-history"></i> Minhas Marcações Hoje</h4>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Data</th>
                                    <th>Entrada</th>
                                    <th>Pausa</th>
                                    <th>Saída</th>
                                    <th>Total Horas</th>
                                    <th>Estado</th>
                                </tr>
                            </thead>
                            <tbody id="teamMyTime">
                                <!-- Marcações do usuário serão carregadas aqui -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- GPS da Obra Obrigatório -->
            <div class="dashboard-section" id="teamGPSSection">
                <div class="content-card">
                    <div class="card-header">
                        <h3><i class="fas fa-map-marker-alt"></i> GPS da Obra (OBRIGATÓRIO)</h3>
                        <button class="btn-dashboard btn-success" onclick="sendMyGPS()">
                            <i class="fas fa-satellite"></i> Enviar GPS Atual
                        </button>
                    </div>

                    <div class="gps-tracker">
                        <div class="gps-info">
                            <i class="fas fa-map-marker-alt" style="font-size: 2rem;"></i>
                            <div>
                                <h4 style="margin: 0;">Localização da Obra</h4>
                                <p>O patrão monitoriza a localização em tempo real</p>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group-dashboard">
                                <label>Nome da Obra *</label>
                                <input type="text" id="teamWorkName" placeholder="Ex: Pavimentação Rua Central" required>
                            </div>
                            <div class="form-group-dashboard">
                                <label>Localidade *</label>
                                <input type="text" id="teamLocation" placeholder="Ex: Berlim - Alemanha" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group-dashboard">
                                <label>Coordenadas GPS *</label>
                                <input type="text" id="teamGPSCoords" placeholder="Ex: 52.5200° N, 13.4050° E" required>
                            </div>
                            <div class="form-group-dashboard">
                                <label>WhatsApp (Opcional)</label>
                                <input type="text" id="teamWhatsApp" placeholder="+351 912 345 678">
                            </div>
                        </div>

                        <div class="form-actions">
                            <button class="btn-dashboard btn-primary" onclick="registerTeamLocation()">
                                <i class="fas fa-save"></i> Registar Localização
                            </button>
                            <button class="btn-dashboard btn-success" onclick="sendGPSWhatsApp()">
                                <i class="fab fa-whatsapp"></i> WhatsApp Patrão (Opcional)
                            </button>
                        </div>
                    </div>

                    <div style="margin-top: 20px;">
                        <h4><i class="fas fa-history"></i> Histórico de Localizações</h4>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Data/Hora</th>
                                    <th>Obra</th>
                                    <th>Localidade</th>
                                    <th>GPS</th>
                                    <th>Patrão Viu</th>
                                </tr>
                            </thead>
                            <tbody id="teamGPSHistory">
                                <!-- Histórico GPS será carregado aqui -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Gestão da Minha Equipa -->
            <div class="dashboard-section" id="teamMyTeamSection">
                <div class="content-card">
                    <div class="card-header">
                        <h3><i class="fas fa-users"></i> Gestão da Minha Equipa</h3>
                        <button class="btn-dashboard btn-success" onclick="openTeamMemberModal()">
                            <i class="fas fa-plus"></i> Adicionar Membro
                        </button>
                    </div>

                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i>
                        <div>
                            <strong>Informação:</strong> Gerencie os membros da sua equipa. O patrão tem acesso a toda a informação.
                        </div>
                    </div>

                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Cargo</th>
                                <th>Entrada Hoje</th>
                                <th>Saída Hoje</th>
                                <th>GPS Atual</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="teamMembersTable">
                            <!-- Membros da equipa serão carregados aqui -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- MENU NO FUNDO PARA CHEFE DE EQUIPA -->
        <nav class="bottom-menu">
            <div class="bottom-menu-container">
                <a href="#" class="bottom-menu-item active" data-section="teamTime">
                    <i class="fas fa-clock"></i>
                    <span>Marcar Horas</span>
                </a>
                <a href="#" class="bottom-menu-item" data-section="teamGPS">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>GPS Obra</span>
                </a>
                <a href="#" class="bottom-menu-item" data-section="teamMyTeam">
                    <i class="fas fa-users"></i>
                    <span>Minha Equipa</span>
                </a>
            </div>
        </nav>
    </div>

    <!-- ============ DASHBOARD COMPRAS ============ -->
    <div class="dashboard purchase-dashboard" id="purchaseDashboard">
        <!-- Top Bar -->
        <div class="top-bar">
            <div class="container top-bar-content">
                <div class="dashboard-brand">
                    <i class="fas fa-shopping-cart"></i>
                    <h1>Compras - MAFC</h1>
                </div>
                <div class="dashboard-info">
                    <div class="user-info">
                        <i class="fas fa-user-tie"></i>
                        <span id="purchaseUserName">Compras</span>
                    </div>
                    <div id="purchaseCurrentTime" style="font-weight: 600;">10:45 AM</div>
                    <button class="logout-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Sair
                    </button>
                </div>
            </div>
        </div>

        <!-- Conteúdo -->
        <div class="dashboard-content">
            <!-- Marcação Obrigatória de Horas -->
            <div class="dashboard-section active" id="purchaseTimeSection">
                <div class="content-card">
                    <div class="card-header">
                        <h3><i class="fas fa-clock"></i> Marcação Obrigatória de Horas</h3>
                        <div class="time-display" style="font-size: 2.5rem; color: var(--purchase);" id="purchaseClock">
                            08:45:23
                        </div>
                    </div>

                    <div class="time-tracker">
                        <div class="time-buttons">
                            <button class="btn-dashboard btn-success" onclick="markPurchaseTime('entry')">
                                <i class="fas fa-sign-in-alt"></i> ENTRADA OBRIGATÓRIA
                            </button>
                            <button class="btn-dashboard btn-warning" onclick="markPurchaseTime('break_start')">
                                <i class="fas fa-coffee"></i> INÍCIO PAUSA
                            </button>
                            <button class="btn-dashboard btn-danger" onclick="markPurchaseTime('exit')">
                                <i class="fas fa-sign-out-alt"></i> SAÍDA OBRIGATÓRIA
                            </button>
                        </div>
                    </div>

                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i>
                        <div>
                            <strong>Importante:</strong> Todas as marcações são monitorizadas pelo patrão. Mantenha o registo atualizado.
                        </div>
                    </div>

                    <div style="margin-top: 20px;">
                        <h4><i class="fas fa-history"></i> Minhas Marcações Hoje</h4>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Data</th>
                                    <th>Entrada</th>
                                    <th>Pausa</th>
                                    <th>Saída</th>
                                    <th>Total Horas</th>
                                    <th>Estado</th>
                                </tr>
                            </thead>
                            <tbody id="purchaseMyTime">
                                <!-- Marcações do usuário serão carregadas aqui -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Gestão de Compras -->
            <div class="dashboard-section" id="purchaseManagementSection">
                <div class="content-card">
                    <div class="card-header">
                        <h3><i class="fas fa-shopping-cart"></i> Gestão de Compras</h3>
                        <button class="btn-dashboard btn-success" onclick="openPurchaseOrderModal()">
                            <i class="fas fa-plus"></i> Nova Ordem
                        </button>
                    </div>

                    <div class="filter-bar">
                        <input type="date" id="purchaseDate" value="<?php echo date('Y-m-d'); ?>">
                        <select id="purchaseStatusFilter">
                            <option value="all">Todos Estados</option>
                            <option value="pending">Pendentes</option>
                            <option value="approved">Aprovadas</option>
                            <option value="completed">Concluídas</option>
                        </select>
                        <button class="btn-dashboard btn-primary" onclick="loadPurchaseOrders()">
                            <i class="fas fa-sync-alt"></i> Atualizar
                        </button>
                    </div>

                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Nº Ordem</th>
                                <th>Fornecedor</th>
                                <th>Material</th>
                                <th>Valor</th>
                                <th>Data</th>
                                <th>Estado</th>
                                <th>Patrão Viu</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="purchaseOrdersTable">
                            <!-- Ordens de compra serão carregadas aqui -->
                        </tbody>
                    </table>

                    <div class="form-actions">
                        <button class="btn-dashboard btn-primary" onclick="printPurchaseAccountingReport()">
                            <i class="fas fa-print"></i> Imprimir para Contabilidade
                        </button>
                        <button class="btn-dashboard btn-danger" onclick="clearOldPurchaseOrders()">
                            <i class="fas fa-trash"></i> Limpar Antigas
                        </button>
                    </div>
                </div>
            </div>

            <!-- Meu Extrato de Compras -->
            <div class="dashboard-section" id="purchaseReportsSection">
                <div class="content-card">
                    <div class="card-header">
                        <h3><i class="fas fa-file-invoice"></i> Meu Extrato de Compras</h3>
                        <button class="btn-dashboard btn-success" onclick="generatePurchaseReport()">
                            <i class="fas fa-sync-alt"></i> Gerar Relatório
                        </button>
                    </div>

                    <div class="form-row">
                        <div class="form-group-dashboard">
                            <label>Período</label>
                            <select id="purchaseReportPeriod">
                                <option value="month">Este Mês</option>
                                <option value="week">Esta Semana</option>
                                <option value="today">Hoje</option>
                                <option value="custom">Personalizado</option>
                            </select>
                        </div>
                        <div class="form-group-dashboard" id="purchaseCustomDates" style="display: none;">
                            <label>Datas Personalizadas</label>
                            <input type="date" id="purchaseDateFrom" style="margin-bottom: 5px;">
                            <input type="date" id="purchaseDateTo">
                        </div>
                    </div>

                    <div class="monthly-report">
                        <div class="report-header">
                            <h4 id="purchaseReportTitle">Relatório de Compras</h4>
                            <span class="badge badge-success" id="purchaseTotalValue">€0,00</span>
                        </div>
                        
                        <table class="time-sheet-table">
                            <thead>
                                <tr>
                                    <th>Data</th>
                                    <th>Ordem</th>
                                    <th>Fornecedor</th>
                                    <th>Descrição</th>
                                    <th>Valor</th>
                                    <th>Estado</th>
                                </tr>
                            </thead>
                            <tbody id="purchaseReportBody">
                                <!-- Dados do relatório serão carregados aqui -->
                            </tbody>
                        </table>
                        
                        <div class="report-actions">
                            <button class="btn-dashboard btn-primary" onclick="printPurchaseAccounting()">
                                <i class="fas fa-print"></i> Para Contabilidade
                            </button>
                            <button class="btn-dashboard btn-whatsapp" onclick="sendPurchaseReportWhatsApp()">
                                <i class="fab fa-whatsapp"></i> WhatsApp (Opcional)
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- MENU NO FUNDO PARA COMPRAS -->
        <nav class="bottom-menu">
            <div class="bottom-menu-container">
                <a href="#" class="bottom-menu-item active" data-section="purchaseTime">
                    <i class="fas fa-clock"></i>
                    <span>Marcar Horas</span>
                </a>
                <a href="#" class="bottom-menu-item" data-section="purchaseManagement">
                    <i class="fas fa-shopping-cart"></i>
                    <span>Compras</span>
                </a>
                <a href="#" class="bottom-menu-item" data-section="purchaseReports">
                    <i class="fas fa-file-alt"></i>
                    <span>Meu Extrato</span>
                </a>
            </div>
        </nav>
    </div>

    <!-- ============ MODAIS ============ -->
    <!-- Modal Gestão de Pessoal -->
    <div class="modal-employee" id="employeeModal">
        <div class="modal-employee-content">
            <button class="close-modal-btn" onclick="closeModal('employeeModal')">&times;</button>
            <h2><i class="fas fa-user-plus"></i> Gestão de Pessoal</h2>
            
            <div class="employee-form">
                <input type="hidden" id="employeeId">
                <div class="form-row">
                    <div class="form-group-dashboard">
                        <label>Nome Completo *</label>
                        <input type="text" id="employeeName" placeholder="Nome completo" required>
                    </div>
                    <div class="form-group-dashboard">
                        <label>WhatsApp (Opcional)</label>
                        <input type="tel" id="employeeWhatsApp" placeholder="+351 912 345 678" value="+351 ">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group-dashboard">
                        <label>Cargo/Função *</label>
                        <select id="employeePosition" required>
                            <option value="">Selecione o cargo</option>
                            <option value="chefe_equipa">Chefe de Equipa</option>
                            <option value="operario">Operário</option>
                            <option value="administrativo">Administrativo</option>
                            <option value="contabilidade">Contabilidade</option>
                            <option value="compras">Compras</option>
                            <option value="gestor">Gestor</option>
                        </select>
                    </div>
                    <div class="form-group-dashboard">
                        <label>Departamento *</label>
                        <select id="employeeDepartment" required>
                            <option value="">Selecione o departamento</option>
                            <option value="office">Escritório</option>
                            <option value="construction">Obra</option>
                            <option value="purchase">Compras</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group-dashboard">
                        <label>Equipa (se aplicável)</label>
                        <input type="text" id="employeeTeam" placeholder="Ex: Equipa 01 - Berlim">
                    </div>
                    <div class="form-group-dashboard">
                        <label>Estado *</label>
                        <select id="employeeStatus" required>
                            <option value="active">Ativo</option>
                            <option value="inactive">Inativo</option>
                            <option value="ferias">Férias</option>
                            <option value="baixa">Baixa Médica</option>
                        </select>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-dashboard btn-success" onclick="saveEmployee()">
                        <i class="fas fa-save"></i> Guardar
                    </button>
                    <button type="button" class="btn-dashboard btn-danger" onclick="closeModal('employeeModal')">
                        <i class="fas fa-times"></i> Cancelar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal GPS -->
    <div class="modal-gps" id="gpsModal">
        <div class="modal-gps-content">
            <button class="close-modal-btn" onclick="closeModal('gpsModal')">&times;</button>
            <h2><i class="fas fa-map-marker-alt"></i> Registar Localização GPS</h2>
            
            <div class="alert alert-warning">
                <i class="fas fa-exclamation-triangle"></i>
                <div>
                    <strong>OBRIGATÓRIO:</strong> O patrão monitoriza todas as localizações. Registre sempre a localização da obra.
                </div>
            </div>

            <div class="form-row">
                <div class="form-group-dashboard">
                    <label>Nome da Equipa *</label>
                    <input type="text" id="gpsTeamName" placeholder="Ex: Equipa 01 - Pavimentação" required>
                </div>
                <div class="form-group-dashboard">
                    <label>Nome da Obra *</label>
                    <input type="text" id="gpsWorkName" placeholder="Ex: Pavimentação Rua Central" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group-dashboard">
                    <label>Localidade *</label>
                    <input type="text" id="gpsLocation" placeholder="Ex: Berlim, Alemanha" required>
                </div>
                <div class="form-group-dashboard">
                    <label>Coordenadas GPS *</label>
                    <input type="text" id="gpsCoords" placeholder="Ex: 52.5200° N, 13.4050° E" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group-dashboard">
                    <label>WhatsApp (Opcional)</label>
                    <input type="text" id="gpsWhatsApp" placeholder="+351 912 345 678">
                </div>
            </div>

            <div class="form-actions">
                <button class="btn-dashboard btn-success" onclick="saveGPSLocation()">
                    <i class="fas fa-save"></i> Registar Localização
                </button>
                <button class="btn-dashboard btn-whatsapp" onclick="sendGPSLocationWhatsApp()">
                    <i class="fab fa-whatsapp"></i> Enviar WhatsApp (Opcional)
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Confirmação Limpeza -->
    <div class="modal" id="confirmClearModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-exclamation-triangle"></i> Confirmação</h2>
                <button class="close-modal" onclick="closeModal('confirmClearModal')">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirmClearMessage">Tem certeza que deseja realizar esta ação?</p>
                <div style="display: flex; gap: 15px; margin-top: 30px;">
                    <button class="btn-dashboard btn-danger" onclick="confirmClearAction()" style="flex: 1;">
                        <i class="fas fa-check"></i> SIM
                    </button>
                    <button class="btn-dashboard btn-primary" onclick="closeModal('confirmClearModal')" style="flex: 1;">
                        <i class="fas fa-times"></i> NÃO
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============ SISTEMA COMPLETO MAFC ============
        
        const MAFCSystem = {
            currentUser: null,
            editingEmployeeId: null,
            
            // Credenciais
            credentials: {
                boss: [
                    { code: 'mafc', password: '1234', name: 'Administrador' },
                    { code: 'admin', password: 'admin123', name: 'Gestor Geral' }
                ],
                team: [
                    { code: 'equipa01', password: '1234', name: 'João Silva', team: 'Equipa 01 - Berlim' },
                    { code: 'equipa02', password: '1234', name: 'Carlos Mendes', team: 'Equipa 02 - Hamburgo' },
                    { code: 'equipa03', password: '1234', name: 'António Santos', team: 'Equipa 03 - Lisboa' },
                    { code: 'equipa04', password: '1234', name: 'Miguel Costa', team: 'Equipa 04 - Porto' },
                    { code: 'equipa05', password: '1234', name: 'Ricardo Oliveira', team: 'Equipa 05 - Frankfurt' },
                    { code: 'equipa06', password: '1234', name: 'Pedro Martins', team: 'Equipa 06 - Munique' },
                    { code: 'equipa07', password: '1234', name: 'Francisco Lima', team: 'Equipa 07 - Colônia' },
                    { code: 'equipa08', password: '1234', name: 'Jorge Silva', team: 'Equipa 08 - Estugarda' },
                    { code: 'equipa09', password: '1234', name: 'Rui Pereira', team: 'Equipa 09 - Düsseldorf' },
                    { code: 'equipa10', password: '1234', name: 'Luís Fernandes', team: 'Equipa 10 - Essen' },
                    { code: 'equipa11', password: '1234', name: 'Hugo Rodrigues', team: 'Equipa 11 - Dortmund' },
                    { code: 'equipa12', password: '1234', name: 'Bruno Sousa', team: 'Equipa 12 - Bremen' },
                    { code: 'equipa13', password: '1234', name: 'Paulo Gomes', team: 'Equipa 13 - Hanôver' },
                    { code: 'equipa14', password: '1234', name: 'Vítor Lopes', team: 'Equipa 14 - Nuremberga' },
                    { code: 'equipa15', password: '1234', name: 'André Marques', team: 'Equipa 15 - Leipzig' }
                ],
                purchase: [
                    { code: 'compras', password: '1234', name: 'Responsável Compras' }
                ],
                office: [
                    { code: 'escritorio', password: '1234', name: 'Maria Silva' },
                    { code: 'contabilidade', password: '1234', name: 'Ana Costa' }
                ]
            },
            
            // Dados do sistema
            employees: [],
            timeRecords: {},
            gpsLocations: [],
            purchaseOrders: [],
            auditLog: [],
            
            // Inicializar dados
            init: function() {
                this.loadFromStorage();
                
                // Inicializar dados padrão se necessário
                if (this.employees.length === 0) {
                    this.employees = [
                        { 
                            id: 1, 
                            name: 'Maria Silva', 
                            whatsapp: '+351912345678', 
                            position: 'Administrativa', 
                            department: 'office', 
                            team: '',
                            status: 'active',
                            role: 'office'
                        },
                        { 
                            id: 2, 
                            name: 'João Silva', 
                            whatsapp: '+351912345679', 
                            position: 'Chefe de Equipa', 
                            department: 'construction', 
                            team: 'Equipa 01 - Berlim',
                            status: 'active',
                            role: 'team'
                        },
                        { 
                            id: 3, 
                            name: 'Carlos Compras', 
                            whatsapp: '+351912345680', 
                            position: 'Responsável Compras', 
                            department: 'purchase', 
                            team: '',
                            status: 'active',
                            role: 'purchase'
                        }
                    ];
                }
                
                this.saveToStorage();
            },
            
            // Salvar no localStorage
            saveToStorage: function() {
                const data = {
                    employees: this.employees,
                    timeRecords: this.timeRecords,
                    gpsLocations: this.gpsLocations,
                    purchaseOrders: this.purchaseOrders,
                    auditLog: this.auditLog
                };
                localStorage.setItem('mafcSystem', JSON.stringify(data));
            },
            
            // Carregar do localStorage
            loadFromStorage: function() {
                const data = JSON.parse(localStorage.getItem('mafcSystem'));
                if (data) {
                    this.employees = data.employees || [];
                    this.timeRecords = data.timeRecords || {};
                    this.gpsLocations = data.gpsLocations || [];
                    this.purchaseOrders = data.purchaseOrders || [];
                    this.auditLog = data.auditLog || [];
                }
            },
            
            // Log de auditoria
            logAudit: function(action, details, user = null) {
                const logEntry = {
                    id: Date.now(),
                    timestamp: new Date().toISOString(),
                    user: user || (this.currentUser ? this.currentUser.name : 'system'),
                    userRole: this.currentUser ? this.currentUser.role : 'system',
                    action: action,
                    details: details
                };
                
                this.auditLog.unshift(logEntry);
                
                // Manter apenas últimos 1000 registos
                if (this.auditLog.length > 1000) this.auditLog.pop();
                
                this.saveToStorage();
            },
            
            // Encontrar funcionário atual
            getCurrentEmployee: function() {
                if (!this.currentUser) return null;
                return this.employees.find(emp => 
                    emp.name === this.currentUser.name && 
                    emp.role === this.currentUser.role
                );
            }
        };
        
        // ============ INICIALIZAÇÃO ============
        document.addEventListener('DOMContentLoaded', function() {
            MAFCSystem.init();
            updateClocks();
            setInterval(updateClocks, 1000);
            
            // Event listeners
            document.getElementById('openLogin').addEventListener('click', function(e) {
                e.preventDefault();
                document.getElementById('loginModal').style.display = 'flex';
            });
            
            document.querySelector('.close-modal').addEventListener('click', function() {
                document.getElementById('loginModal').style.display = 'none';
            });
            
            window.addEventListener('click', function(e) {
                if (e.target === document.getElementById('loginModal')) {
                    document.getElementById('loginModal').style.display = 'none';
                }
            });
            
            // Login form
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                handleLogin();
            });
            
            // Menu navigation
            document.querySelectorAll('.bottom-menu-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const dashboard = this.closest('.dashboard');
                    const sectionId = this.getAttribute('data-section') + 'Section';
                    
                    // Remover active de todos os items do mesmo dashboard
                    dashboard.querySelectorAll('.bottom-menu-item').forEach(i => {
                        i.classList.remove('active');
                    });
                    
                    // Adicionar active ao item clicado
                    this.classList.add('active');
                    
                    // Esconder todas as seções do dashboard
                    dashboard.querySelectorAll('.dashboard-section').forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    // Mostrar seção selecionada
                    const section = document.getElementById(sectionId);
                    if (section) {
                        section.classList.add('active');
                        loadSectionData(sectionId);
                    }
                });
            });
            
            // Event listeners para filtros
            document.getElementById('purchaseReportPeriod').addEventListener('change', function() {
                const customDates = document.getElementById('purchaseCustomDates');
                customDates.style.display = this.value === 'custom' ? 'block' : 'none';
            });
        });
        
        // ============ FUNÇÕES DE LOGIN ============
        function handleLogin() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const role = document.getElementById('role').value;
            
            let userFound = null;
            
            if (role && MAFCSystem.credentials[role]) {
                userFound = MAFCSystem.credentials[role].find(u => 
                    u.code === username && u.password === password
                );
            }
            
            if (userFound) {
                MAFCSystem.currentUser = { ...userFound, role };
                MAFCSystem.logAudit('login', `Login realizado como ${role} - ${userFound.name}`);
                loginSuccess();
            } else {
                alert('Credenciais incorretas! Utilize:\n\nADMIN: mafc / 1234\nEQUIPAS: equipa01 a equipa15 / 1234\nCOMPRAS: compras / 1234\nESCRITÓRIO: escritorio / 1234');
            }
        }
        
        function loginSuccess() {
            document.getElementById('loginModal').style.display = 'none';
            document.getElementById('publicWebsite').style.display = 'none';
            
            // Mostrar dashboard apropriado
            const dashboardMap = {
                'boss': 'bossDashboard',
                'team': 'teamDashboard',
                'purchase': 'purchaseDashboard',
                'office': 'officeDashboard'
            };
            
            const dashboardId = dashboardMap[MAFCSystem.currentUser.role];
            if (dashboardId) {
                document.getElementById(dashboardId).style.display = 'block';
                
                // Atualizar nome do usuário
                const userNameElement = document.getElementById(dashboardId.replace('Dashboard', 'UserName'));
                if (userNameElement) {
                    userNameElement.textContent = MAFCSystem.currentUser.name;
                }
                
                // Inicializar dashboard
                initializeDashboard();
            }
        }
        
        function logout() {
            if (confirm('Tem certeza que deseja sair do sistema?')) {
                MAFCSystem.logAudit('logout', 'Logout realizado');
                
                // Esconder todos os dashboards
                document.querySelectorAll('.dashboard').forEach(d => {
                    d.style.display = 'none';
                });
                
                // Mostrar website público
                document.getElementById('publicWebsite').style.display = 'block';
                
                // Fechar todos os modais
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.style.display = 'none';
                });
                
                // Limpar formulário de login
                document.getElementById('loginForm').reset();
                MAFCSystem.currentUser = null;
            }
        }
        
        // ============ FUNÇÕES GERAIS ============
        function updateClocks() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('pt-PT');
            const timeShort = now.toLocaleTimeString('pt-PT', { hour: '2-digit', minute: '2-digit' });
            
            // Atualizar todos os relógios
            ['boss', 'team', 'purchase', 'office'].forEach(role => {
                const element = document.getElementById(`${role}CurrentTime`);
                if (element) element.textContent = timeShort;
                
                const clockElement = document.getElementById(`${role}Clock`);
                if (clockElement) clockElement.textContent = timeString;
            });
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        function loadSectionData(sectionId) {
            switch(sectionId) {
                case 'bossOverviewSection':
                    loadBossOverview();
                    break;
                case 'bossHoursSection':
                    loadAllTimeRecords();
                    break;
                case 'bossGPSSection':
                    loadAllGPSLocations();
                    break;
                case 'bossPeopleSection':
                    loadBossPeople();
                    break;
                case 'bossAuditSection':
                    loadAuditLog();
                    break;
                case 'officeTimeSection':
                    loadMyTimeRecords('office');
                    break;
                case 'officePeopleSection':
                    loadOfficePeople();
                    break;
                case 'officeReportsSection':
                    // Carregar extrato ao abrir
                    break;
                case 'teamTimeSection':
                    loadMyTimeRecords('team');
                    break;
                case 'teamGPSSection':
                    loadTeamGPS();
                    break;
                case 'teamMyTeamSection':
                    loadTeamMembers();
                    break;
                case 'purchaseTimeSection':
                    loadMyTimeRecords('purchase');
                    break;
                case 'purchaseManagementSection':
                    loadPurchaseOrders();
                    break;
                case 'purchaseReportsSection':
                    // Carregar relatório ao abrir
                    break;
            }
        }
        
        function initializeDashboard() {
            // Carregar dados iniciais do dashboard atual
            const activeSection = document.querySelector('.dashboard-section.active');
            if (activeSection) {
                loadSectionData(activeSection.id);
            }
            
            // Carregar contadores gerais
            updateDashboardCounters();
        }
        
        function updateDashboardCounters() {
            // Atualizar contadores do patrão
            if (MAFCSystem.currentUser.role === 'boss') {
                document.getElementById('totalEmployees').textContent = MAFCSystem.employees.length;
                document.getElementById('activeTeams').textContent = new Set(MAFCSystem.employees
                    .filter(e => e.department === 'construction' && e.status === 'active')
                    .map(e => e.team)).size;
                
                // Calcular horas hoje
                const today = new Date().toLocaleDateString('pt-PT');
                const todayRecords = MAFCSystem.timeRecords[today] || {};
                let totalHours = 0;
                Object.values(todayRecords).forEach(record => {
                    if (record.totalHours) totalHours += parseFloat(record.totalHours);
                });
                document.getElementById('todayHours').textContent = totalHours.toFixed(1);
                
                // Pendentes (funcionários sem marcação hoje)
                const activeEmployees = MAFCSystem.employees.filter(e => e.status === 'active');
                const markedToday = Object.keys(todayRecords).length;
                document.getElementById('pendingItems').textContent = activeEmployees.length - markedToday;
            }
        }
        
        // ============ MARCAÇÃO DE HORAS OBRIGATÓRIA ============
        function markOfficeTime(type) {
            markTime(type, 'office');
        }
        
        function markTeamTime(type) {
            markTime(type, 'team');
        }
        
        function markPurchaseTime(type) {
            markTime(type, 'purchase');
        }
        
        function markTime(type, role) {
            const employee = MAFCSystem.getCurrentEmployee();
            if (!employee) {
                alert('Erro: Funcionário não encontrado!');
                return;
            }
            
            const now = new Date();
            const timeString = now.toLocaleTimeString('pt-PT', { hour: '2-digit', minute: '2-digit' });
            const dateString = now.toLocaleDateString('pt-PT');
            const dateTimeString = now.toISOString();
            
            // Inicializar registos do dia se necessário
            if (!MAFCSystem.timeRecords[dateString]) {
                MAFCSystem.timeRecords[dateString] = {};
            }
            
            const employeeId = employee.id.toString();
            if (!MAFCSystem.timeRecords[dateString][employeeId]) {
                MAFCSystem.timeRecords[dateString][employeeId] = {
                    employeeId: employee.id,
                    employeeName: employee.name,
                    department: employee.department,
                    team: employee.team || '',
                    records: []
                };
            }
            
            const dayRecord = MAFCSystem.timeRecords[dateString][employeeId];
            
            // Adicionar novo registo
            const record = {
                type: type,
                time: timeString,
                timestamp: dateTimeString
            };
            
            dayRecord.records.push(record);
            
            // Ordenar registos por timestamp
            dayRecord.records.sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));
            
            // Calcular horas totais
            calculateTotalHours(dayRecord);
            
            MAFCSystem.saveToStorage();
            
            // Log de auditoria
            const actionMap = {
                'entry': 'Entrada',
                'break_start': 'Início de pausa',
                'break_end': 'Fim de pausa',
                'exit': 'Saída'
            };
            
            MAFCSystem.logAudit('time_mark', `${actionMap[type] || type} às ${timeString} - ${employee.name}`);
            
            // Mostrar confirmação
            const messages = {
                'entry': `✅ ENTRADA registada às ${timeString}\n\nO patrão foi notificado.`,
                'break_start': `⏸️ PAUSA INICIADA às ${timeString}`,
                'break_end': `▶️ PAUSA TERMINADA às ${timeString}`,
                'exit': `✅ SAÍDA registada às ${timeString}\n\nTotal de horas hoje: ${dayRecord.totalHours || '0'}h\nO patrão foi notificado.`
            };
            
            alert(messages[type] || `Registo realizado às ${timeString}`);
            
            // Atualizar interface
            loadMyTimeRecords(role);
            updateDashboardCounters();
            
            // Se for saída, mostrar resumo
            if (type === 'exit' && dayRecord.totalHours) {
                setTimeout(() => {
                    alert(`📊 RESUMO DO DIA\n\nNome: ${employee.name}\nEntrada: ${dayRecord.entryTime || '--:--'}\nSaída: ${timeString}\nTotal: ${dayRecord.totalHours}h\n\nRegisto guardado para contabilidade.`);
                }, 500);
            }
        }
        
        function calculateTotalHours(dayRecord) {
            const records = dayRecord.records;
            
            // Encontrar entrada e saída
            const entryRecord = records.find(r => r.type === 'entry');
            const exitRecord = records.find(r => r.type === 'exit');
            
            if (entryRecord && exitRecord) {
                const entryTime = new Date(entryRecord.timestamp);
                const exitTime = new Date(exitRecord.timestamp);
                
                // Calcular diferença em horas
                let diffHours = (exitTime - entryTime) / (1000 * 60 * 60);
                
                // Subtrair tempo de pausa
                let pauseStart = null;
                records.forEach(record => {
                    if (record.type === 'break_start') {
                        pauseStart = new Date(record.timestamp);
                    } else if (record.type === 'break_end' && pauseStart) {
                        const pauseEnd = new Date(record.timestamp);
                        const pauseHours = (pauseEnd - pauseStart) / (1000 * 60 * 60);
                        diffHours -= pauseHours;
                        pauseStart = null;
                    }
                });
                
                dayRecord.entryTime = entryRecord.time;
                dayRecord.exitTime = exitRecord.time;
                dayRecord.totalHours = diffHours.toFixed(2);
            }
        }
        
        function loadMyTimeRecords(role) {
            const employee = MAFCSystem.getCurrentEmployee();
            if (!employee) return;
            
            const today = new Date().toLocaleDateString('pt-PT');
            const todayRecords = MAFCSystem.timeRecords[today] || {};
            const employeeRecord = todayRecords[employee.id] || { records: [] };
            
            const tableId = role + 'MyTime';
            const tbody = document.getElementById(tableId);
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            if (employeeRecord.records.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="7" style="text-align: center; color: #666;">Sem marcações hoje</td>`;
                tbody.appendChild(row);
                return;
            }
            
            // Agrupar por tipo para display
            const entryRecord = employeeRecord.records.find(r => r.type === 'entry');
            const exitRecord = employeeRecord.records.find(r => r.type === 'exit');
            const pauseRecords = employeeRecord.records.filter(r => r.type.includes('break'));
            
            let pauseStart = null;
            let pauseEnd = null;
            pauseRecords.forEach(record => {
                if (record.type === 'break_start') pauseStart = record.time;
                if (record.type === 'break_end') pauseEnd = record.time;
            });
            
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${today}</td>
                <td>${entryRecord ? entryRecord.time : '--:--'}</td>
                <td>${pauseStart || '--:--'}</td>
                <td>${pauseEnd || '--:--'}</td>
                <td>${exitRecord ? exitRecord.time : '--:--'}</td>
                <td>${employeeRecord.totalHours || '0.00'}h</td>
                <td>${exitRecord ? '<span class="badge badge-success">Concluído</span>' : '<span class="badge badge-warning">Em trabalho</span>'}</td>
            `;
            tbody.appendChild(row);
        }
        
        // ============ GESTÃO DE PESSOAL ============
        function openEmployeeModal(context) {
            MAFCSystem.editingEmployeeId = null;
            document.getElementById('employeeModal').style.display = 'flex';
            
            // Configurar baseado no contexto
            const deptSelect = document.getElementById('employeeDepartment');
            if (context === 'office') {
                deptSelect.value = 'office';
                deptSelect.disabled = true;
            } else if (context === 'boss') {
                deptSelect.disabled = false;
            }
            
            // Limpar formulário
            document.getElementById('employeeId').value = '';
            document.getElementById('employeeName').value = '';
            document.getElementById('employeeWhatsApp').value = '+351 ';
            document.getElementById('employeePosition').value = '';
            document.getElementById('employeeTeam').value = '';
            document.getElementById('employeeStatus').value = 'active';
        }
        
        function saveEmployee() {
            const id = document.getElementById('employeeId').value;
            const name = document.getElementById('employeeName').value;
            const whatsapp = document.getElementById('employeeWhatsApp').value;
            const position = document.getElementById('employeePosition').value;
            const department = document.getElementById('employeeDepartment').value;
            const team = document.getElementById('employeeTeam').value;
            const status = document.getElementById('employeeStatus').value;
            
            if (!name || !position || !department) {
                alert('Por favor, preencha todos os campos obrigatórios!');
                return;
            }
            
            // Determinar role baseado no departamento
            let role = 'employee';
            if (department === 'office') role = 'office';
            else if (department === 'construction') role = 'team';
            else if (department === 'purchase') role = 'purchase';
            
            if (id) {
                // Editar funcionário existente
                const index = MAFCSystem.employees.findIndex(e => e.id == id);
                if (index !== -1) {
                    MAFCSystem.employees[index] = {
                        ...MAFCSystem.employees[index],
                        name,
                        whatsapp,
                        position,
                        department,
                        team,
                        status,
                        role
                    };
                    MAFCSystem.logAudit('employee_update', `Atualizou funcionário: ${name}`);
                }
            } else {
                // Adicionar novo funcionário
                const newId = MAFCSystem.employees.length > 0 ? 
                    Math.max(...MAFCSystem.employees.map(e => e.id)) + 1 : 1;
                
                MAFCSystem.employees.push({
                    id: newId,
                    name,
                    whatsapp,
                    position,
                    department,
                    team,
                    status,
                    role
                });
                MAFCSystem.logAudit('employee_create', `Adicionou funcionário: ${name}`);
            }
            
            MAFCSystem.saveToStorage();
            alert('Funcionário guardado com sucesso!');
            
            // Atualizar interfaces
            if (MAFCSystem.currentUser.role === 'boss') {
                loadBossPeople();
            } else if (MAFCSystem.currentUser.role === 'office') {
                loadOfficePeople();
            }
            
            updateDashboardCounters();
            closeModal('employeeModal');
        }
        
        function loadBossPeople() {
            const tbody = document.getElementById('bossPeopleTable');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            MAFCSystem.employees.forEach(employee => {
                const statusBadge = employee.status === 'active' ? 
                    '<span class="badge badge-success">Ativo</span>' :
                    '<span class="badge badge-danger">Inativo</span>';
                
                const departmentMap = {
                    'office': 'Escritório',
                    'construction': 'Obra',
                    'purchase': 'Compras'
                };
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${employee.name}</td>
                    <td>${employee.whatsapp || '--'}</td>
                    <td>${employee.position}</td>
                    <td>${departmentMap[employee.department] || employee.department}</td>
                    <td>${employee.team || '--'}</td>
                    <td>${statusBadge}</td>
                    <td>
                        <button class="btn-dashboard btn-sm btn-warning" onclick="editEmployee(${employee.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-dashboard btn-sm btn-danger" onclick="deleteEmployee(${employee.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function loadOfficePeople() {
            const tbody = document.getElementById('officePeopleTable');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            const today = new Date().toLocaleDateString('pt-PT');
            const todayRecords = MAFCSystem.timeRecords[today] || {};
            
            MAFCSystem.employees
                .filter(e => e.department === 'office')
                .forEach(employee => {
                    const employeeRecord = todayRecords[employee.id] || {};
                    const statusBadge = employee.status === 'active' ? 
                        '<span class="badge badge-success">Ativo</span>' :
                        '<span class="badge badge-danger">Inativo</span>';
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${employee.name}</td>
                        <td>${employee.position}</td>
                        <td>${employeeRecord.entryTime || '--:--'}</td>
                        <td>${employeeRecord.exitTime || '--:--'}</td>
                        <td>${employeeRecord.totalHours || '0.00'}h</td>
                        <td>${statusBadge}</td>
                        <td>
                            <button class="btn-dashboard btn-sm btn-warning" onclick="editEmployee(${employee.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
        }
        
        function editEmployee(id) {
            const employee = MAFCSystem.employees.find(e => e.id == id);
            if (!employee) return;
            
            MAFCSystem.editingEmployeeId = id;
            document.getElementById('employeeModal').style.display = 'flex';
            
            // Preencher formulário
            document.getElementById('employeeId').value = employee.id;
            document.getElementById('employeeName').value = employee.name;
            document.getElementById('employeeWhatsApp').value = employee.whatsapp || '+351 ';
            document.getElementById('employeePosition').value = employee.position;
            document.getElementById('employeeDepartment').value = employee.department;
            document.getElementById('employeeTeam').value = employee.team || '';
            document.getElementById('employeeStatus').value = employee.status;
            
            // Desabilitar departamento se não for patrão
            if (MAFCSystem.currentUser.role !== 'boss') {
                document.getElementById('employeeDepartment').disabled = true;
            }
        }
        
        function deleteEmployee(id) {
            if (!confirm('Tem certeza que deseja remover este funcionário?')) return;
            
            const employee = MAFCSystem.employees.find(e => e.id == id);
            if (employee) {
                MAFCSystem.employees = MAFCSystem.employees.filter(e => e.id != id);
                MAFCSystem.logAudit('employee_delete', `Removeu funcionário: ${employee.name}`);
                MAFCSystem.saveToStorage();
                
                alert('Funcionário removido com sucesso!');
                
                // Atualizar interfaces
                if (MAFCSystem.currentUser.role === 'boss') {
                    loadBossPeople();
                } else if (MAFCSystem.currentUser.role === 'office') {
                    loadOfficePeople();
                }
                
                updateDashboardCounters();
            }
        }
        
        function searchBossPeople() {
            const search = document.getElementById('bossSearchPerson').value.toLowerCase();
            const dept = document.getElementById('bossFilterDept').value;
            const status = document.getElementById('bossFilterStatus').value;
            
            const tbody = document.getElementById('bossPeopleTable');
            const rows = tbody.getElementsByTagName('tr');
            
            for (let row of rows) {
                const cells = row.getElementsByTagName('td');
                const name = cells[0].textContent.toLowerCase();
                const department = cells[3].textContent.toLowerCase();
                const statusText = cells[5].textContent.toLowerCase();
                
                const matchesSearch = name.includes(search);
                const matchesDept = dept === 'all' || department.includes(dept);
                const matchesStatus = status === 'all' || statusText.includes(status);
                
                row.style.display = matchesSearch && matchesDept && matchesStatus ? '' : 'none';
            }
        }
        
        function searchOfficePeople() {
            const search = document.getElementById('officeSearchPerson').value.toLowerCase();
            const status = document.getElementById('officeFilterStatus').value;
            
            const tbody = document.getElementById('officePeopleTable');
            const rows = tbody.getElementsByTagName('tr');
            
            for (let row of rows) {
                const cells = row.getElementsByTagName('td');
                const name = cells[0].textContent.toLowerCase();
                const statusText = cells[5].textContent.toLowerCase();
                
                const matchesSearch = name.includes(search);
                const matchesStatus = status === 'all' || statusText.includes(status);
                
                row.style.display = matchesSearch && matchesStatus ? '' : 'none';
            }
        }
        
        // ============ GPS DAS EQUIPAS ============
        function sendMyGPS() {
            document.getElementById('gpsModal').style.display = 'flex';
            
            // Preencher dados da equipa se for chefe de equipa
            const employee = MAFCSystem.getCurrentEmployee();
            if (employee && employee.department === 'construction') {
                document.getElementById('gpsTeamName').value = employee.team || '';
                document.getElementById('gpsWhatsApp').value = employee.whatsapp || '';
            }
        }
        
        function registerTeamLocation() {
            const employee = MAFCSystem.getCurrentEmployee();
            if (!employee) return;
            
            const teamName = document.getElementById('gpsTeamName').value;
            const workName = document.getElementById('gpsWorkName').value;
            const location = document.getElementById('gpsLocation').value;
            const coords = document.getElementById('gpsCoords').value;
            const whatsapp = document.getElementById('gpsWhatsApp').value;
            
            if (!teamName || !workName || !location || !coords) {
                alert('Por favor, preencha todos os campos obrigatórios!');
                return;
            }
            
            const gpsRecord = {
                id: Date.now(),
                timestamp: new Date().toISOString(),
                teamName,
                workName,
                location,
                coords,
                employeeId: employee.id,
                employeeName: employee.name,
                whatsapp: whatsapp || employee.whatsapp,
                seenByBoss: false
            };
            
            MAFCSystem.gpsLocations.unshift(gpsRecord);
            MAFCSystem.saveToStorage();
            MAFCSystem.logAudit('gps_location', `Registou localização GPS: ${location} - ${coords}`);
            
            alert(`✅ Localização GPS registada!\n\nEquipa: ${teamName}\nObra: ${workName}\nLocal: ${location}\nGPS: ${coords}\n\nO patrão foi notificado.`);
            
            // Marcar como visto pelo patrão (simulação)
            setTimeout(() => {
                gpsRecord.seenByBoss = true;
                MAFCSystem.saveToStorage();
                if (MAFCSystem.currentUser.role === 'team') {
                    loadTeamGPS();
                }
            }, 1000);
            
            closeModal('gpsModal');
        }
        
        function loadTeamGPS() {
            const employee = MAFCSystem.getCurrentEmployee();
            if (!employee) return;
            
            const tbody = document.getElementById('teamGPSHistory');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            const teamGPS = MAFCSystem.gpsLocations
                .filter(gps => gps.employeeId === employee.id)
                .slice(0, 10);
            
            if (teamGPS.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="5" style="text-align: center; color: #666;">Sem registos GPS</td>`;
                tbody.appendChild(row);
                return;
            }
            
            teamGPS.forEach(gps => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${new Date(gps.timestamp).toLocaleString('pt-PT')}</td>
                    <td>${gps.workName}</td>
                    <td>${gps.location}</td>
                    <td><code>${gps.coords}</code></td>
                    <td>${gps.seenByBoss ? '✅ Sim' : '⏳ Pendente'}</td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function loadAllGPSLocations() {
            const tbody = document.getElementById('bossTeamsGPS');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            // Agrupar por equipa
            const teams = {};
            MAFCSystem.gpsLocations.forEach(gps => {
                if (!teams[gps.teamName]) {
                    teams[gps.teamName] = gps;
                }
            });
            
            Object.values(teams).slice(0, 15).forEach(gps => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${gps.teamName}</td>
                    <td>${gps.workName}</td>
                    <td>${new Date(gps.timestamp).toLocaleString('pt-PT')}</td>
                    <td><code>${gps.coords}</code></td>
                    <td>${gps.whatsapp || '--'}</td>
                    <td>
                        <button class="btn-dashboard btn-sm btn-info" onclick="viewGPSDetails('${gps.teamName}')">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn-dashboard btn-sm btn-whatsapp" onclick="contactTeamGPS('${gps.teamName}')">
                            <i class="fab fa-whatsapp"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function sendGPSLocationWhatsApp() {
            const teamName = document.getElementById('gpsTeamName').value;
            const workName = document.getElementById('gpsWorkName').value;
            const location = document.getElementById('gpsLocation').value;
            const coords = document.getElementById('gpsCoords').value;
            const whatsapp = document.getElementById('gpsWhatsApp').value;
            
            if (!teamName || !workName || !location || !coords) {
                alert('Por favor, preencha os campos obrigatórios primeiro!');
                return;
            }
            
            const message = `📍 LOCALIZAÇÃO GPS - ${teamName}\n\nObra: ${workName}\nLocal: ${location}\nCoordenadas: ${coords}\n\nEnviado via Sistema MAFC`;
            
            const phone = whatsapp || '351123456789'; // Número padrão do patrão
            window.open(`https://wa.me/${phone.replace(/\D/g, '')}?text=${encodeURIComponent(message)}`, '_blank');
        }
        
        // ============ CONTROL O TOTAL DE HORAS (PATRÃO) ============
        function loadAllTimeRecords() {
            const date = document.getElementById('bossHoursDate').value;
            const dept = document.getElementById('bossFilterDept').value;
            
            const tbody = document.getElementById('bossAllTimeRecords');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            // Converter data para formato pt-PT
            const dateObj = new Date(date);
            const dateString = dateObj.toLocaleDateString('pt-PT');
            const dayRecords = MAFCSystem.timeRecords[dateString] || {};
            
            let hasRecords = false;
            
            Object.values(dayRecords).forEach(record => {
                // Filtrar por departamento
                if (dept !== 'all' && record.department !== dept) return;
                
                hasRecords = true;
                
                const employee = MAFCSystem.employees.find(e => e.id == record.employeeId);
                if (!employee) return;
                
                const departmentMap = {
                    'office': 'Escritório',
                    'construction': 'Obra',
                    'purchase': 'Compras'
                };
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${record.employeeName}</td>
                    <td>${departmentMap[record.department] || record.department}</td>
                    <td>${record.team || '--'}</td>
                    <td>${record.entryTime || '--:--'}</td>
                    <td>${record.exitTime || '--:--'}</td>
                    <td>${record.totalHours || '0.00'}h</td>
                    <td>${record.exitTime ? '<span class="badge badge-success">Concluído</span>' : '<span class="badge badge-warning">Em trabalho</span>'}</td>
                    <td>
                        ${record.team ? 
                            `<button class="btn-dashboard btn-sm btn-info" onclick="viewTeamGPS('${record.team}')">
                                <i class="fas fa-map-marker-alt"></i>
                            </button>` : 
                            '--'
                        }
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            if (!hasRecords) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="8" style="text-align: center; color: #666;">Sem registos para esta data</td>`;
                tbody.appendChild(row);
            }
        }
        
        // ============ AUDITORIA (PATRÃO) ============
        function loadAuditLog() {
            const tbody = document.getElementById('bossAuditTable');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            MAFCSystem.auditLog.slice(0, 100).forEach(log => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${new Date(log.timestamp).toLocaleString('pt-PT')}</td>
                    <td>${log.user}</td>
                    <td>${log.userRole}</td>
                    <td>${log.action}</td>
                    <td>${log.details}</td>
                    <td>Local</td>
                    <td>
                        <input type="checkbox" class="audit-checkbox" data-id="${log.id}">
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function filterAudit() {
            const dateFrom = document.getElementById('auditDateFrom').value;
            const dateTo = document.getElementById('auditDateTo').value;
            const user = document.getElementById('auditUserFilter').value;
            
            // Implementar filtragem
            loadAuditLog(); // Por enquanto recarrega tudo
        }
        
        // ============ FUNÇÕES DE IMPRESSÃO PARA CONTABILIDADE ============
        function printAllTimeReport() {
            const date = document.getElementById('bossHoursDate').value;
            const dateObj = new Date(date);
            const dateString = dateObj.toLocaleDateString('pt-PT');
            const dayRecords = MAFCSystem.timeRecords[dateString] || {};
            
            let reportHTML = `
                <html>
                <head>
                    <title>Relatório de Horas - ${dateString}</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        h1 { color: #333; text-align: center; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                        th, td { border: 1px solid #000; padding: 8px; text-align: left; }
                        th { background-color: #f2f2f2; }
                        .total-row { font-weight: bold; background-color: #e8e8e8; }
                        .footer { margin-top: 50px; text-align: center; font-size: 12px; }
                    </style>
                </head>
                <body>
                    <h1>MAFC & FILHO, LDA. - Relatório de Horas</h1>
                    <p><strong>Data:</strong> ${dateString}</p>
                    <p><strong>Emitido por:</strong> ${MAFCSystem.currentUser.name}</p>
                    <p><strong>Emitido em:</strong> ${new Date().toLocaleString('pt-PT')}</p>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Departamento</th>
                                <th>Equipa</th>
                                <th>Entrada</th>
                                <th>Saída</th>
                                <th>Total Horas</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            let totalHours = 0;
            Object.values(dayRecords).forEach(record => {
                const employee = MAFCSystem.employees.find(e => e.id == record.employeeId);
                if (!employee) return;
                
                const hours = parseFloat(record.totalHours) || 0;
                totalHours += hours;
                
                reportHTML += `
                    <tr>
                        <td>${record.employeeName}</td>
                        <td>${record.department}</td>
                        <td>${record.team || '--'}</td>
                        <td>${record.entryTime || '--:--'}</td>
                        <td>${record.exitTime || '--:--'}</td>
                        <td>${record.totalHours || '0.00'}h</td>
                    </tr>
                `;
            });
            
            reportHTML += `
                        </tbody>
                        <tfoot>
                            <tr class="total-row">
                                <td colspan="5"><strong>TOTAL GERAL</strong></td>
                                <td><strong>${totalHours.toFixed(2)}h</strong></td>
                            </tr>
                        </tfoot>
                    </table>
                    
                    <div class="footer">
                        <p>Documento válido para efeitos de contabilidade e processamento de salários</p>
                        <p>________________________________</p>
                        <p>Assinatura do Responsável</p>
                    </div>
                </body>
                </html>
            `;
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(reportHTML);
            printWindow.document.close();
            printWindow.print();
            
            MAFCSystem.logAudit('print_report', `Imprimiu relatório de horas para ${dateString}`);
        }
        
        function printMyAccountingReport() {
            const employee = MAFCSystem.getCurrentEmployee();
            if (!employee) return;
            
            const month = document.getElementById('officeReportMonth').value;
            const [monthNum, year] = month.split('-');
            const monthNames = ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 
                               'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
            const monthName = monthNames[parseInt(monthNum) - 1];
            
            // Buscar registos do mês
            let totalHours = 0;
            let reportRows = '';
            
            Object.keys(MAFCSystem.timeRecords).forEach(dateStr => {
                const date = new Date(dateStr.split('/').reverse().join('-'));
                if (date.getMonth() + 1 == monthNum && date.getFullYear() == year) {
                    const dayRecords = MAFCSystem.timeRecords[dateStr];
                    if (dayRecords && dayRecords[employee.id]) {
                        const record = dayRecords[employee.id];
                        const hours = parseFloat(record.totalHours) || 0;
                        totalHours += hours;
                        
                        reportRows += `
                            <tr>
                                <td>${dateStr}</td>
                                <td>${record.entryTime || '--:--'}</td>
                                <td>${record.exitTime || '--:--'}</td>
                                <td>${hours > 8 ? '8.00' : hours.toFixed(2)}</td>
                                <td>${hours > 8 ? (hours - 8).toFixed(2) : '0.00'}</td>
                                <td>${hours.toFixed(2)}</td>
                            </tr>
                        `;
                    }
                }
            });
            
            const reportHTML = `
                <html>
                <head>
                    <title>Extrato de Horas - ${employee.name} - ${monthName} ${year}</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        h1 { color: #333; text-align: center; }
                        .header-info { display: flex; justify-content: space-between; margin-bottom: 30px; }
                        .company-info { font-size: 14px; }
                        .employee-info { text-align: right; font-size: 14px; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                        th, td { border: 1px solid #000; padding: 8px; text-align: left; }
                        th { background-color: #f2f2f2; }
                        .total-row { font-weight: bold; background-color: #e8e8e8; }
                        .footer { margin-top: 50px; text-align: center; font-size: 12px; }
                        .signatures { display: flex; justify-content: space-between; margin-top: 80px; }
                        .signature-line { width: 200px; border-top: 1px solid #000; text-align: center; padding-top: 5px; }
                    </style>
                </head>
                <body>
                    <div class="header-info">
                        <div class="company-info">
                            <h2>MAFC & FILHO, LDA.</h2>
                            <p>Construção Civil & Obras Públicas</p>
                            <p>NIF: 500000000</p>
                        </div>
                        <div class="employee-info">
                            <h3>EXTRATO DE HORAS</h3>
                            <p><strong>Funcionário:</strong> ${employee.name}</p>
                            <p><strong>Mês:</strong> ${monthName} ${year}</p>
                            <p><strong>Cargo:</strong> ${employee.position}</p>
                            <p><strong>Departamento:</strong> ${employee.department}</p>
                        </div>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>Data</th>
                                <th>Entrada</th>
                                <th>Saída</th>
                                <th>Horas Normais</th>
                                <th>Horas Extra</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${reportRows}
                        </tbody>
                        <tfoot>
                            <tr class="total-row">
                                <td colspan="3"><strong>TOTAIS</strong></td>
                                <td><strong>${Math.min(totalHours, 8 * 22).toFixed(2)}</strong></td>
                                <td><strong>${Math.max(0, totalHours - 8 * 22).toFixed(2)}</strong></td>
                                <td><strong>${totalHours.toFixed(2)}</strong></td>
                            </tr>
                        </tfoot>
                    </table>
                    
                    <div class="footer">
                        <p>Documento válido para efeitos de contabilidade e processamento de salários</p>
                        
                        <div class="signatures">
                            <div class="signature-line">
                                Funcionário<br>
                                ${employee.name}
                            </div>
                            <div class="signature-line">
                                Responsável Departamento<br>
                                ________________________________
                            </div>
                            <div class="signature-line">
                                Contabilidade<br>
                                ________________________________
                            </div>
                        </div>
                    </div>
                </body>
                </html>
            `;
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(reportHTML);
            printWindow.document.close();
            printWindow.print();
            
            MAFCSystem.logAudit('print_my_report', `Imprimiu extrato pessoal para ${monthName} ${year}`);
        }
        
        // ============ FUNÇÕES DE LIMPEZA ============
        function showClearConfirmation(message, action) {
            document.getElementById('confirmClearMessage').textContent = message;
            window.clearAction = action;
            document.getElementById('confirmClearModal').style.display = 'flex';
        }
        
        function confirmClearAction() {
            if (window.clearAction) {
                window.clearAction();
            }
            closeModal('confirmClearModal');
        }
        
        function clearAllTimeRecords() {
            showClearConfirmation(
                'Tem certeza que deseja limpar TODOS os registos de horas do sistema?\n\nEsta ação não pode ser desfeita!',
                function() {
                    MAFCSystem.timeRecords = {};
                    MAFCSystem.saveToStorage();
                    MAFCSystem.logAudit('clear_all_time', 'Limpou todos os registos de horas');
                    alert('Todos os registos de horas foram limpos!');
                    loadAllTimeRecords();
                    updateDashboardCounters();
                }
            );
        }
        
        function clearAuditLog() {
            showClearConfirmation(
                'Tem certeza que deseja limpar TODO o histórico de auditoria?\n\nEsta ação não pode ser desfeita!',
                function() {
                    MAFCSystem.auditLog = [];
                    MAFCSystem.saveToStorage();
                    MAFCSystem.logAudit('clear_audit', 'Limpou histórico de auditoria');
                    alert('Histórico de auditoria limpo!');
                    loadAuditLog();
                }
            );
        }
        
        function deleteAllInactive() {
            showClearConfirmation(
                'Tem certeza que deseja remover TODOS os funcionários inativos?\n\nEsta ação não pode ser desfeita!',
                function() {
                    const inactiveCount = MAFCSystem.employees.filter(e => e.status === 'inactive').length;
                    MAFCSystem.employees = MAFCSystem.employees.filter(e => e.status !== 'inactive');
                    MAFCSystem.saveToStorage();
                    MAFCSystem.logAudit('delete_all_inactive', `Removeu ${inactiveCount} funcionários inativos`);
                    alert(`${inactiveCount} funcionários inativos removidos!`);
                    loadBossPeople();
                    updateDashboardCounters();
                }
            );
        }
        
        // ============ FUNÇÕES DE CARREGAMENTO INICIAL ============
        function loadBossOverview() {
            // Carregar alertas
            const alertsDiv = document.getElementById('bossAlerts');
            alertsDiv.innerHTML = '';
            
            // Alertas de funcionários sem marcação hoje
            const today = new Date().toLocaleDateString('pt-PT');
            const todayRecords = MAFCSystem.timeRecords[today] || {};
            const activeEmployees = MAFCSystem.employees.filter(e => e.status === 'active');
            const missingMarks = activeEmployees.filter(e => !todayRecords[e.id]);
            
            if (missingMarks.length > 0) {
                const alert = document.createElement('div');
                alert.className = 'alert alert-warning';
                alert.innerHTML = `
                    <i class="fas fa-user-clock"></i>
                    <div>
                        <strong>${missingMarks.length} funcionários sem marcação hoje</strong>
                        <p>Verificar marcação de horas</p>
                    </div>
                `;
                alertsDiv.appendChild(alert);
            }
            
            // Carregar atividade recente
            const activityTbody = document.getElementById('bossActivityLog');
            activityTbody.innerHTML = '';
            
            MAFCSystem.auditLog.slice(0, 5).forEach(log => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${new Date(log.timestamp).toLocaleTimeString('pt-PT')}</td>
                    <td>${log.user}</td>
                    <td>${log.action}</td>
                    <td>${log.details}</td>
                `;
                activityTbody.appendChild(row);
            });
        }
        
        // ============ FUNÇÕES DE EQUIPA ============
        function loadTeamMembers() {
            const employee = MAFCSystem.getCurrentEmployee();
            if (!employee || !employee.team) return;
            
            const tbody = document.getElementById('teamMembersTable');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            const teamMembers = MAFCSystem.employees.filter(e => 
                e.team === employee.team && e.department === 'construction'
            );
            
            const today = new Date().toLocaleDateString('pt-PT');
            const todayRecords = MAFCSystem.timeRecords[today] || {};
            
            teamMembers.forEach(member => {
                const memberRecord = todayRecords[member.id] || {};
                const latestGPS = MAFCSystem.gpsLocations
                    .filter(gps => gps.employeeId === member.id)
                    .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp))[0];
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${member.name}</td>
                    <td>${member.position}</td>
                    <td>${memberRecord.entryTime || '--:--'}</td>
                    <td>${memberRecord.exitTime || '--:--'}</td>
                    <td>${latestGPS ? latestGPS.coords : '--'}</td>
                    <td>
                        <button class="btn-dashboard btn-sm btn-info" onclick="viewMemberDetails(${member.id})">
                            <i class="fas fa-eye"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        // ============ FUNÇÕES DE COMPRAS ============
        function loadPurchaseOrders() {
            const tbody = document.getElementById('purchaseOrdersTable');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            // Simular dados de compras
            const sampleOrders = [
                { id: 1, number: 'ORD-2024-001', supplier: 'Cimentos Portugal', material: 'Cimento', value: 1250.50, date: '2024-12-01', status: 'completed', seenByBoss: true },
                { id: 2, number: 'ORD-2024-002', supplier: 'Ferragens Lda.', material: 'Parafusos', value: 345.20, date: '2024-12-02', status: 'approved', seenByBoss: true },
                { id: 3, number: 'ORD-2024-003', supplier: 'Madeiras Nobres', material: 'Madeira', value: 2100.00, date: '2024-12-03', status: 'pending', seenByBoss: false }
            ];
            
            sampleOrders.forEach(order => {
                const statusMap = {
                    'pending': { class: 'badge-warning', text: 'Pendente' },
                    'approved': { class: 'badge-info', text: 'Aprovado' },
                    'completed': { class: 'badge-success', text: 'Concluído' }
                };
                
                const status = statusMap[order.status] || statusMap.pending;
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${order.number}</td>
                    <td>${order.supplier}</td>
                    <td>${order.material}</td>
                    <td>€${order.value.toFixed(2)}</td>
                    <td>${order.date}</td>
                    <td><span class="badge ${status.class}">${status.text}</span></td>
                    <td>${order.seenByBoss ? '✅' : '⏳'}</td>
                    <td>
                        <button class="btn-dashboard btn-sm btn-info">
                            <i class="fas fa-eye"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        // ============ FUNÇÕES DE UTILIDADE ADICIONAIS ============
        function markAllAlertsRead() {
            alert('Todos os alertas marcados como lidos!');
        }
        
        function refreshActivity() {
            loadBossOverview();
            alert('Atividade atualizada!');
        }
        
        function refreshAllGPS() {
            loadAllGPSLocations();
            alert('Localizações GPS atualizadas!');
        }
        
        function requestAllGPS() {
            alert('Pedido de localização GPS enviado a todas as equipas!');
        }
        
        function viewGPSHistory() {
            alert('Mostrando histórico completo de GPS...');
        }
        
        function deleteInactiveOfficePeople() {
            const inactiveOffice = MAFCSystem.employees.filter(e => 
                e.department === 'office' && e.status === 'inactive'
            ).length;
            
            if (inactiveOffice === 0) {
                alert('Não há funcionários inativos no escritório!');
                return;
            }
            
            if (confirm(`Remover ${inactiveOffice} funcionários inativos do escritório?`)) {
                MAFCSystem.employees = MAFCSystem.employees.filter(e => 
                    !(e.department === 'office' && e.status === 'inactive')
                );
                MAFCSystem.saveToStorage();
                MAFCSystem.logAudit('delete_inactive_office', `Removeu ${inactiveOffice} funcionários inativos do escritório`);
                alert(`${inactiveOffice} funcionários inativos removidos!`);
                loadOfficePeople();
                updateDashboardCounters();
            }
        }
        
        function clearOldPurchaseOrders() {
            alert('Função de limpeza de ordens antigas ativada!');
        }
        
        function viewGPSDetails(teamName) {
            alert(`Mostrando detalhes GPS da ${teamName}...`);
        }
        
        function contactTeamGPS(teamName) {
            const message = `📍 MAFC - Verificação GPS\n\nPor favor, confirme a localização atual da ${teamName}.`;
            window.open(`https://wa.me/?text=${encodeURIComponent(message)}`, '_blank');
        }
        
        function viewTeamGPS(teamName) {
            alert(`Mostrando localização GPS da ${teamName}...`);
        }
        
        function clearSelectedAudit() {
            const checkboxes = document.querySelectorAll('.audit-checkbox:checked');
            if (checkboxes.length === 0) {
                alert('Selecione registos para limpar!');
                return;
            }
            
            if (confirm(`Limpar ${checkboxes.length} registos selecionados?`)) {
                checkboxes.forEach(cb => {
                    const id = parseInt(cb.dataset.id);
                    MAFCSystem.auditLog = MAFCSystem.auditLog.filter(log => log.id !== id);
                });
                MAFCSystem.saveToStorage();
                MAFCSystem.logAudit('clear_selected_audit', `Limpou ${checkboxes.length} registos de auditoria`);
                alert(`${checkboxes.length} registos limpos!`);
                loadAuditLog();
            }
        }
        
        function exportAuditLog() {
            alert('Exportando histórico de auditoria para Excel...');
        }
        
        function exportPeopleList() {
            alert('Exportando lista de funcionários para Excel...');
        }
        
        function exportAllTimeData() {
            alert('Exportando todos os dados de horas para Excel...');
        }
        
        function printAccountingReport() {
            printAllTimeReport();
        }
        
        function printOfficeAccountingReport() {
            printMyAccountingReport();
        }
        
        function generateMyMonthlyReport() {
            alert('Extrato mensal gerado! Utilize o botão "IMPRIMIR para Contabilidade".');
        }
        
        function sendMyReportWhatsApp() {
            const employee = MAFCSystem.getCurrentEmployee();
            if (!employee) return;
            
            const message = `📊 MAFC - Meu Extrato de Horas\n\nFuncionário: ${employee.name}\nSolicito verificação do meu extrato de horas.\n\nObrigado!`;
            window.open(`https://wa.me/?text=${encodeURIComponent(message)}`, '_blank');
        }
        
        function openPurchaseOrderModal() {
            alert('Abrindo formulário para nova ordem de compra...');
        }
        
        function generatePurchaseReport() {
            alert('Relatório de compras gerado! Utilize o botão "Para Contabilidade".');
        }
        
        function printPurchaseAccounting() {
            alert('Imprimindo relatório de compras para contabilidade...');
        }
        
        function sendPurchaseReportWhatsApp() {
            const message = `🛒 MAFC - Relatório de Compras\n\nSolicito verificação do relatório de compras.\n\nObrigado!`;
            window.open(`https://wa.me/?text=${encodeURIComponent(message)}`, '_blank');
        }
        
        function openTeamMemberModal() {
            alert('Abrindo formulário para adicionar membro à equipa...');
        }
        
        function viewMemberDetails(memberId) {
            alert(`Mostrando detalhes do membro ID: ${memberId}`);
        }
        
        // Inicializar sistema
        MAFCSystem.init();
    </script>
</body>
</html>
