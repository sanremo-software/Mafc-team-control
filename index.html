<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAFC & FILHO, LDA. - Construção Civil & Obras Públicas</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #1a5f7a;
            --secondary: #2d9cdb;
            --accent: #ff9f1c;
            --dark: #003049;
            --light: #f8f9fa;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
            --construction: #e67e22;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: var(--light);
        }

        /* Header & Navigation */
        header {
            background: linear-gradient(135deg, var(--dark), var(--primary));
            color: white;
            padding: 1rem 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo i {
            font-size: 2.5rem;
            color: var(--accent);
        }

        .logo-text h1 {
            font-size: 1.8rem;
            font-weight: 700;
        }

        .logo-text span {
            color: var(--accent);
            font-weight: 300;
            font-size: 1rem;
            display: block;
            margin-top: 5px;
        }

        .cta-buttons {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .btn {
            padding: 10px 25px;
            border-radius: 50px;
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            font-size: 1rem;
        }

        .btn-whatsapp {
            background: #25D366;
            color: white;
        }

        .btn-whatsapp:hover {
            background: #1da851;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(37, 211, 102, 0.3);
        }

        .btn-email {
            background: var(--accent);
            color: var(--dark);
        }

        .btn-email:hover {
            background: #ffb143;
            transform: translateY(-2px);
        }

        .btn-login {
            background: var(--primary);
            color: white;
        }

        .btn-login:hover {
            background: var(--dark);
            transform: translateY(-2px);
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(rgba(0, 48, 73, 0.85), rgba(0, 48, 73, 0.9)), url('https://images.unsplash.com/photo-1504307651254-35680f356dfd?ixlib=rb-4.0.3&auto=format&fit=crop&w=1600&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 200px 0 150px;
            text-align: center;
            margin-top: 80px;
        }

        .hero h2 {
            font-size: 3.5rem;
            margin-bottom: 20px;
            font-weight: 800;
            text-transform: uppercase;
            text-shadow: 2px 2px 5px rgba(0,0,0,0.3);
        }

        .hero p {
            font-size: 1.3rem;
            max-width: 800px;
            margin: 0 auto 40px;
            opacity: 0.9;
        }

        .hero-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 40px;
        }

        /* Services */
        .services {
            padding: 100px 0;
            background: white;
        }

        .section-title {
            text-align: center;
            font-size: 2.5rem;
            color: var(--dark);
            margin-bottom: 60px;
            position: relative;
        }

        .section-title:after {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: var(--accent);
        }

        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 50px;
        }

        .service-card {
            background: var(--light);
            padding: 40px 30px;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .service-card:hover {
            transform: translateY(-10px);
            border-color: var(--accent);
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
        }

        .service-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 20px;
        }

        .service-card h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: var(--dark);
        }

        /* Company Info */
        .company-info {
            padding: 100px 0;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-top: 50px;
        }

        .info-card {
            text-align: center;
            padding: 30px;
        }

        .info-card i {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 20px;
        }

        .info-card h3 {
            font-size: 2.5rem;
            color: var(--dark);
            margin-bottom: 10px;
        }

        /* Gallery */
        .gallery {
            padding: 100px 0;
            background: white;
        }

        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 50px;
        }

        .gallery-item {
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            height: 250px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s;
        }

        .gallery-item:hover img {
            transform: scale(1.1);
        }

        .gallery-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 48, 73, 0.8);
            color: white;
            padding: 15px;
            transform: translateY(100%);
            transition: transform 0.3s;
        }

        .gallery-item:hover .gallery-overlay {
            transform: translateY(0);
        }

        /* Quote Request */
        .quote-request {
            background: var(--dark);
            color: white;
            padding: 80px 0;
            text-align: center;
        }

        .quote-request h2 {
            font-size: 2.5rem;
            margin-bottom: 20px;
        }

        .quote-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 40px;
            flex-wrap: wrap;
        }

        /* Footer */
        footer {
            background: var(--dark);
            color: white;
            padding: 60px 0 30px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-column h3 {
            font-size: 1.3rem;
            margin-bottom: 25px;
            color: var(--accent);
        }

        .contact-info i {
            margin-right: 10px;
            color: var(--accent);
        }

        .copyright {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(255,255,255,0.1);
            color: #aaa;
            font-size: 0.9rem;
        }

        /* Login Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            width: 90%;
            max-width: 500px;
            border-radius: 15px;
            overflow: hidden;
            animation: modalAppear 0.5s;
        }

        @keyframes modalAppear {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-header {
            background: var(--dark);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .modal-header h2 {
            font-size: 1.8rem;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 1.5rem;
            cursor: pointer;
            color: white;
        }

        .modal-body {
            padding: 40px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark);
            font-weight: 600;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border 0.3s;
        }

        .form-group input:focus, .form-group select:focus {
            border-color: var(--primary);
            outline: none;
        }

        .login-submit {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
        }

        .login-submit:hover {
            background: var(--dark);
        }

        /* Admin Dashboard */
        .admin-dashboard {
            display: none;
            margin-top: 80px;
            min-height: calc(100vh - 80px);
        }

        .dashboard-header {
            background: var(--dark);
            color: white;
            padding: 15px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        .dashboard-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .dashboard-title h1 {
            font-size: 1.5rem;
        }

        .logout-btn {
            background: var(--danger);
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 250px 1fr;
            min-height: calc(100vh - 110px);
            margin-top: 50px;
        }

        .sidebar {
            background: var(--light);
            padding: 30px 0;
            border-right: 1px solid #ddd;
            position: fixed;
            height: calc(100vh - 110px);
            overflow-y: auto;
            width: 250px;
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu li {
            margin-bottom: 5px;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            padding: 15px 25px;
            color: var(--dark);
            text-decoration: none;
            transition: all 0.3s;
            border-left: 4px solid transparent;
        }

        .sidebar-menu a:hover, .sidebar-menu a.active {
            background: rgba(26, 95, 122, 0.1);
            border-left-color: var(--primary);
            color: var(--primary);
        }

        .sidebar-menu i {
            margin-right: 15px;
            width: 20px;
            text-align: center;
        }

        .dashboard-content {
            padding: 30px;
            background: white;
            margin-left: 250px;
            width: calc(100% - 250px);
        }

        /* Team Leader Dashboard */
        .team-dashboard {
            background: #f5f7fa;
        }

        .team-header {
            background: linear-gradient(135deg, var(--secondary), #3498db);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .team-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border-top: 4px solid var(--secondary);
        }

        .stat-card h3 {
            font-size: 2rem;
            color: var(--dark);
            margin-bottom: 10px;
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .action-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            transition: all 0.3s;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .action-card:hover {
            transform: translateY(-5px);
            border-color: var(--secondary);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .action-card i {
            font-size: 2.5rem;
            color: var(--secondary);
            margin-bottom: 15px;
        }

        /* Purchase Manager Dashboard */
        .purchase-dashboard {
            background: #f0f9ff;
        }

        .purchase-header {
            background: linear-gradient(135deg, var(--success), #2ecc71);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        /* Forms */
        .form-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 30px;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        /* Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border-radius: 10px;
            overflow: hidden;
        }

        .data-table th {
            background: var(--primary);
            color: white;
            padding: 15px;
            text-align: left;
        }

        .data-table td {
            padding: 15px;
            border-bottom: 1px solid #eee;
        }

        .data-table tr:hover {
            background: #f9f9f9;
        }

        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
        }

        .status-working { background: #d5f4e6; color: var(--success); }
        .status-pending { background: #fff3cd; color: var(--warning); }
        .status-approved { background: #d1ecf1; color: var(--secondary); }
        .status-overtime { background: #f8d7da; color: var(--danger); }

        /* Material Categories */
        .categories {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }

        .category-tag {
            background: var(--light);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .category-tag:hover, .category-tag.active {
            background: var(--primary);
            color: white;
        }

        /* Mobile Responsive */
        @media (max-width: 992px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                display: none;
            }
            
            .dashboard-content {
                margin-left: 0;
                width: 100%;
            }
            
            .hero h2 {
                font-size: 2.5rem;
            }
            
            .cta-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .hero-buttons {
                flex-direction: column;
                align-items: center;
            }
        }

        @media (max-width: 768px) {
            .hero {
                padding: 150px 0 100px;
            }
            
            .hero h2 {
                font-size: 2rem;
            }
            
            .section-title {
                font-size: 2rem;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Public Website -->
    <div id="publicWebsite">
        <!-- Header -->
        <header>
            <div class="container nav-container">
                <div class="logo">
                    <i class="fas fa-hard-hat"></i>
                    <div class="logo-text">
                        <h1>MAFC & FILHO, LDA.</h1>
                        <span>Construção Civil & Obras Públicas | Desde 2001</span>
                    </div>
                </div>
                <div class="cta-buttons">
                    <a href="https://wa.me/351XXXXXXXXX?text=Olá,%20gostaria%20de%20solicitar%20um%20orçamento%20para%20uma%20obra" class="btn btn-whatsapp" target="_blank">
                        <i class="fab fa-whatsapp"></i> WhatsApp
                    </a>
                    <a href="mailto:orçamentos@mafc-filho.pt?subject=Solicitação de Orçamento&body=Olá MAFC,%0D%0A%0D%0AGostaria de solicitar um orçamento para:" class="btn btn-email">
                        <i class="fas fa-envelope"></i> Pedir Orçamento
                    </a>
                    <a href="#" class="btn btn-login" id="openLogin">
                        <i class="fas fa-sign-in-alt"></i> Acesso Sistema
                    </a>
                </div>
            </div>
        </header>

        <!-- Hero Section -->
        <section class="hero">
            <div class="container">
                <h2>Especialistas em Construção Civil e Obras Públicas</h2>
                <p>Mais de 20 anos de experiência em saneamento, abastecimento de água, redes de fibra óptica, pavimentação e infraestruturas. Operação em Portugal e Alemanha.</p>
                <div class="hero-buttons">
                    <a href="#services" class="btn btn-email">
                        <i class="fas fa-hard-hat"></i> Nossos Serviços
                    </a>
                    <a href="#quote" class="btn btn-whatsapp">
                        <i class="fas fa-calculator"></i> Orçamento Grátis
                    </a>
                </div>
            </div>
        </section>

        <!-- Services -->
        <section class="services" id="services">
            <div class="container">
                <h2 class="section-title">Serviços Especializados</h2>
                <div class="services-grid">
                    <div class="service-card">
                        <div class="service-icon">
                            <i class="fas fa-water"></i>
                        </div>
                        <h3>Saneamento e Águas</h3>
                        <p>Redes de águas pluviais, sistemas de drenagem e abastecimento de água potável.</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">
                            <i class="fas fa-satellite-dish"></i>
                        </div>
                        <h3>Redes de Fibra Óptica</h3>
                        <p>Instalação e manutenção de infraestruturas de telecomunicações.</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">
                            <i class="fas fa-road"></i>
                        </div>
                        <h3>Pavimentação</h3>
                        <p>Pavimentação em cubo, betuminosa e reabilitação de vias públicas.</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <h3>Redes EDP e Gás</h3>
                        <p>Instalação de infraestruturas elétricas e de gás natural.</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">
                            <i class="fas fa-tools"></i>
                        </div>
                        <h3>Infraestruturas Públicas</h3>
                        <p>Obras públicas completas para câmaras municipais e juntas de freguesia.</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">
                            <i class="fas fa-globe-europe"></i>
                        </div>
                        <h3>Operação na Alemanha</h3>
                        <p>Equipas especializadas a trabalhar em projetos internacionais.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Company Info -->
        <section class="company-info">
            <div class="container">
                <h2 class="section-title">MAFC em Números</h2>
                <div class="info-grid">
                    <div class="info-card">
                        <i class="fas fa-calendar-alt"></i>
                        <h3>20+</h3>
                        <p>Anos de Experiência</p>
                    </div>
                    <div class="info-card">
                        <i class="fas fa-users"></i>
                        <h3>40+</h3>
                        <p>Colaboradores</p>
                    </div>
                    <div class="info-card">
                        <i class="fas fa-hard-hat"></i>
                        <h3>15</h3>
                        <p>Equipas Ativas</p>
                    </div>
                    <div class="info-card">
                        <i class="fas fa-flag"></i>
                        <h3>2</h3>
                        <p>Países de Operação</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Gallery -->
        <section class="gallery">
            <div class="container">
                <h2 class="section-title">Nossas Obras</h2>
                <div class="gallery-grid">
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1541888946425-d81bb19240f5?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" alt="Pavimentação">
                        <div class="gallery-overlay">
                            <h4>Pavimentação em Cubo</h4>
                            <p>Área urbana reurbanizada</p>
                        </div>
                    </div>
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1581094794329-c8112a89af12?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" alt="Redes">
                        <div class="gallery-overlay">
                            <h4>Redes de Fibra Óptica</h4>
                            <p>Infraestrutura de telecomunicações</p>
                        </div>
                    </div>
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1504917595217-d4dc5ebe6122?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" alt="Saneamento">
                        <div class="gallery-overlay">
                            <h4>Saneamento Urbano</h4>
                            <p>Redes de águas pluviais</p>
                        </div>
                    </div>
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1533158326339-7f3e096fada4?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" alt="Água">
                        <div class="gallery-overlay">
                            <h4>Abastecimento de Água</h4>
                            <p>Sistemas de adução</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Quote Request -->
        <section class="quote-request" id="quote">
            <div class="container">
                <h2>Solicite um Orçamento Gratuito</h2>
                <p>Tem um projeto de construção? Entre em contacto connosco para uma avaliação personalizada.</p>
                <div class="quote-buttons">
                    <a href="https://wa.me/351XXXXXXXXX?text=Olá,%20gostaria%20de%20solicitar%20um%20orçamento%20para%20uma%20obra" class="btn btn-whatsapp" target="_blank">
                        <i class="fab fa-whatsapp"></i> WhatsApp: +351 XXX XXX XXX
                    </a>
                    <a href="mailto:orçamentos@mafc-filho.pt?subject=Solicitação de Orçamento&body=Olá MAFC,%0D%0A%0D%0AGostaria de solicitar um orçamento para:" class="btn btn-email">
                        <i class="fas fa-envelope"></i> Email: orçamentos@mafc-filho.pt
                    </a>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer>
            <div class="container">
                <div class="footer-content">
                    <div class="footer-column">
                        <h3>MAFC & FILHO, LDA.</h3>
                        <p>Constituída em 2001, somos especialistas em construção civil e obras públicas com operação em Portugal e Alemanha.</p>
                        <div class="contact-info" style="margin-top: 20px;">
                            <p><i class="fas fa-map-marker-alt"></i> Portugal | Alemanha</p>
                            <p><i class="fas fa-phone"></i> +351 XXX XXX XXX</p>
                            <p><i class="fas fa-envelope"></i> info@mafc-filho.pt</p>
                        </div>
                    </div>
                </div>
                <div class="copyright">
                    <p>&copy; 2001-2024 MAFC & FILHO, LDA. - Todos os direitos reservados.</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Acesso ao Sistema MAFC</h2>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="loginForm">
                    <div class="form-group">
                        <label for="username">Código de Acesso</label>
                        <input type="text" id="username" placeholder="mafc" required>
                    </div>
                    <div class="form-group">
                        <label for="password">Senha</label>
                        <input type="password" id="password" placeholder="1234" required>
                    </div>
                    <div class="form-group">
                        <label for="role">Tipo de Acesso</label>
                        <select id="role" required>
                            <option value="admin">Patrão/Administrador</option>
                            <option value="team">Chefe de Equipa</option>
                            <option value="purchase">Responsável de Compras</option>
                        </select>
                    </div>
                    <button type="submit" class="login-submit">
                        <i class="fas fa-sign-in-alt"></i> Entrar no Sistema
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div class="admin-dashboard" id="adminDashboard">
        <div class="dashboard-header">
            <div class="container dashboard-title">
                <h1><i class="fas fa-crown"></i> Painel do Patrão - MAFC Team Control</h1>
                <button class="logout-btn" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Sair</button>
            </div>
        </div>
        <div class="dashboard-grid">
            <div class="sidebar">
                <ul class="sidebar-menu">
                    <li><a href="#" class="active" data-section="overview"><i class="fas fa-tachometer-alt"></i> Visão Geral</a></li>
                    <li><a href="#" data-section="teams"><i class="fas fa-users"></i> Equipas (15)</a></li>
                    <li><a href="#" data-section="workers"><i class="fas fa-user-hard-hat"></i> Trabalhadores</a></li>
                    <li><a href="#" data-section="works"><i class="fas fa-hard-hat"></i> Obras Alemanha</a></li>
                    <li><a href="#" data-section="hours"><i class="fas fa-clock"></i> Controlo de Horas</a></li>
                    <li><a href="#" data-section="overtime"><i class="fas fa-history"></i> Banco de Horas</a></li>
                    <li><a href="#" data-section="materials"><i class="fas fa-boxes"></i> Pedidos de Material</a></li>
                    <li><a href="#" data-section="purchases"><i class="fas fa-shopping-cart"></i> Compras Aprovadas</a></li>
                    <li><a href="#" data-section="expenses"><i class="fas fa-euro-sign"></i> Despesas Totais</a></li>
                    <li><a href="#" data-section="reports"><i class="fas fa-chart-bar"></i> Relatórios</a></li>
                    <li><a href="#" data-section="accounting"><i class="fas fa-file-invoice-dollar"></i> Contabilidade</a></li>
                </ul>
            </div>
            <div class="dashboard-content">
                <!-- All Admin Sections -->
                <div class="dashboard-section active" id="overviewSection">
                    <div class="section-header">
                        <h2>Visão Geral do Sistema</h2>
                        <span id="currentDate">10/12/2024, 08:15</span>
                    </div>
                    
                    <div class="stats-cards">
                        <div class="stat-card">
                            <h3>15</h3>
                            <p>Equipas Ativas</p>
                        </div>
                        <div class="stat-card">
                            <h3>42</h3>
                            <p>Trabalhadores</p>
                        </div>
                        <div class="stat-card">
                            <h3>8</h3>
                            <p>Obras Alemanha</p>
                        </div>
                        <div class="stat-card">
                            <h3>12</h3>
                            <p>Pedidos Pendentes</p>
                        </div>
                    </div>
                    
                    <h3 style="margin: 30px 0 15px;">Equipas em Tempo Real - Alemanha</h3>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Equipa</th>
                                <th>Localização</th>
                                <th>Obra</th>
                                <th>Estado</th>
                                <th>Trabalhadores</th>
                                <th>Horas Hoje</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Equipa 01 - Berlin</td>
                                <td>Berlim, Kreuzberg</td>
                                <td>Saneamento Urbano</td>
                                <td><span class="status-badge status-working">A Trabalhar</span></td>
                                <td>5/5</td>
                                <td>4.5h</td>
                            </tr>
                            <tr>
                                <td>Equipa 02 - Hamburg</td>
                                <td>Hamburgo, Centro</td>
                                <td>Pavimentação</td>
                                <td><span class="status-badge status-working">A Trabalhar</span></td>
                                <td>3/3</td>
                                <td>4.2h</td>
                            </tr>
                            <tr>
                                <td>Equipa 03 - Munich</td>
                                <td>Munique, Subúrbios</td>
                                <td>Redes Fibra Óptica</td>
                                <td><span class="status-badge status-working">A Trabalhar</span></td>
                                <td>4/4</td>
                                <td>4.8h</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- Teams Section -->
                <div class="dashboard-section" id="teamsSection">
                    <div class="section-header">
                        <h2>Gestão das 15 Equipas</h2>
                        <button class="btn btn-primary">Nova Equipa</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nome</th>
                                <th>Chefe</th>
                                <th>Localização</th>
                                <th>Obra</th>
                                <th>GPS</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="teamsTable">
                            <!-- Teams will be loaded here -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Materials Section -->
                <div class="dashboard-section" id="materialsSection">
                    <div class="section-header">
                        <h2>Pedidos de Material das Equipas</h2>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Material</th>
                                <th>Quantidade</th>
                                <th>Equipa</th>
                                <th>Data</th>
                                <th>Estado</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="materialsTable">
                            <!-- Materials will be loaded here -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Accounting Section -->
                <div class="dashboard-section" id="accountingSection">
                    <div class="section-header">
                        <h2>Contabilidade - Exportação para Ficheiro</h2>
                        <button class="btn btn-success" onclick="exportToAccounting()">
                            <i class="fas fa-file-export"></i> Exportar para Contabilidade
                        </button>
                    </div>
                    <div class="form-section">
                        <h3>Horas Trabalhadas > 160h/Mês</h3>
                        <p>Trabalhadores com horas extras para banco de horas:</p>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Trabalhador</th>
                                    <th>Equipa</th>
                                    <th>Horas Normais</th>
                                    <th>Horas Extra</th>
                                    <th>Total</th>
                                    <th>Banco Horas</th>
                                </tr>
                            </thead>
                            <tbody id="overtimeTable">
                                <!-- Overtime data -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Team Leader Dashboard -->
    <div class="admin-dashboard team-dashboard" id="teamDashboard">
        <div class="dashboard-header">
            <div class="container dashboard-title">
                <h1><i class="fas fa-hard-hat"></i> Chefe de Equipa - MAFC Team Control</h1>
                <button class="logout-btn" id="teamLogoutBtn"><i class="fas fa-sign-out-alt"></i> Sair</button>
            </div>
        </div>
        <div class="dashboard-content">
            <div class="team-header">
                <h2>Equipa 01 - Berlin | Saneamento Urbano</h2>
                <p>Chefe: João Silva | Localização: Berlim, Kreuzberg</p>
            </div>
            
            <div class="team-stats">
                <div class="stat-card">
                    <h3 id="teamWorkersCount">5</h3>
                    <p>Trabalhadores</p>
                </div>
                <div class="stat-card">
                    <h3 id="teamHoursToday">4.5</h3>
                    <p>Horas Hoje</p>
                </div>
                <div class="stat-card">
                    <h3 id="teamMaterials">3</h3>
                    <p>Pedidos Pendentes</p>
                </div>
                <div class="stat-card">
                    <h3 id="teamStatus">Online</h3>
                    <p>Estado</p>
                </div>
            </div>
            
            <div class="quick-actions">
                <div class="action-card" onclick="openSection('teamTime')">
                    <i class="fas fa-clock"></i>
                    <h3>Controlo de Horas</h3>
                    <p>Registar entrada/saída da equipa</p>
                </div>
                
                <div class="action-card" onclick="openSection('teamMaterials')">
                    <i class="fas fa-boxes"></i>
                    <h3>Pedir Materiais</h3>
                    <p>Solicitar material para a obra</p>
                </div>
                
                <div class="action-card" onclick="openSection('teamWorkers')">
                    <i class="fas fa-user-plus"></i>
                    <h3>Gestão de Trabalhadores</h3>
                    <p>Adicionar/remover trabalhadores</p>
                </div>
                
                <div class="action-card" onclick="openSection('teamLocation')">
                    <i class="fas fa-map-marker-alt"></i>
                    <h3>Atualizar Localização</h3>
                    <p>Enviar GPS para o patrão</p>
                </div>
            </div>
            
            <!-- Team Time Section -->
            <div class="dashboard-section active" id="teamTimeSection">
                <div class="form-section">
                    <h3><i class="fas fa-clock"></i> Controlo de Horas - Tempo Real</h3>
                    <div class="form-row">
                        <div>
                            <label>Trabalhador</label>
                            <select id="workerSelect">
                                <option value="1">João Silva (Chefe)</option>
                                <option value="2">Carlos Mendes</option>
                                <option value="3">Miguel Santos</option>
                                <option value="4">António Oliveira</option>
                                <option value="5">Pedro Costa</option>
                            </select>
                        </div>
                        <div>
                            <label>Ação</label>
                            <select id="timeAction">
                                <option value="start">Entrada (Stempel)</option>
                                <option value="end">Saída (Ausstempel)</option>
                            </select>
                        </div>
                        <div>
                            <label>Hora Atual</label>
                            <input type="text" id="currentTime" value="08:30" readonly>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button class="btn btn-success" onclick="registerTime()">
                            <i class="fas fa-check"></i> Registar Hora
                        </button>
                        <button class="btn btn-primary" onclick="registerAll('start')">
                            <i class="fas fa-users"></i> Entrada Toda Equipa
                        </button>
                        <button class="btn btn-warning" onclick="registerAll('end')">
                            <i class="fas fa-users"></i> Saída Toda Equipa
                        </button>
                    </div>
                    
                    <h4 style="margin-top: 30px;">Registos de Hoje</h4>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Trabalhador</th>
                                <th>Entrada</th>
                                <th>Saída</th>
                                <th>Total Horas</th>
                                <th>Banco Horas</th>
                            </tr>
                        </thead>
                        <tbody id="timeRecordsTable">
                            <!-- Time records will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Team Materials Section -->
            <div class="dashboard-section" id="teamMaterialsSection">
                <div class="form-section">
                    <h3><i class="fas fa-boxes"></i> Pedido de Material para Obra</h3>
                    
                    <div class="categories">
                        <div class="category-tag active" data-category="all">Todos</div>
                        <div class="category-tag" data-category="materials">Materiais Construção</div>
                        <div class="category-tag" data-category="machines">Máquinas e Equipamentos</div>
                        <div class="category-tag" data-category="tools">Ferramentas</div>
                        <div class="category-tag" data-category="vehicles">Viaturas</div>
                        <div class="category-tag" data-category="consumables">Consumíveis</div>
                    </div>
                    
                    <div class="form-row">
                        <div>
                            <label>Categoria</label>
                            <select id="materialCategory" onchange="filterMaterials()">
                                <option value="materials">Materiais de Construção</option>
                                <option value="machines">Máquinas e Equipamentos</option>
                                <option value="tools">Ferramentas</option>
                                <option value="vehicles">Viaturas</option>
                                <option value="consumables">Consumíveis</option>
                                <option value="other">Outros</option>
                            </select>
                        </div>
                        <div>
                            <label>Material</label>
                            <select id="materialSelect">
                                <!-- Materials will be populated by JavaScript -->
                            </select>
                        </div>
                        <div>
                            <label>Quantidade</label>
                            <input type="number" id="materialQuantity" min="1" value="1">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div>
                            <label>Unidade</label>
                            <select id="materialUnit">
                                <option value="kg">kg</option>
                                <option value="sacos">sacos</option>
                                <option value="ton">toneladas</option>
                                <option value="m3">m³</option>
                                <option value="litros">litros</option>
                                <option value="unidades">unidades</option>
                                <option value="horas">horas</option>
                                <option value="dias">dias</option>
                            </select>
                        </div>
                        <div>
                            <label>Urgência</label>
                            <select id="materialUrgency">
                                <option value="normal">Normal (1-2 semanas)</option>
                                <option value="urgent">Urgente (3-5 dias)</option>
                                <option value="critical">Crítico (24-48h)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div style="grid-column: 1 / -1;">
                            <label>Observações</label>
                            <textarea id="materialNotes" rows="3" placeholder="Detalhes adicionais sobre o material necessário..."></textarea>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button class="btn btn-success" onclick="submitMaterialRequest()">
                            <i class="fas fa-paper-plane"></i> Enviar para Compras
                        </button>
                        <button class="btn btn-primary" onclick="addCustomMaterial()">
                            <i class="fas fa-plus"></i> Adicionar Material Personalizado
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Purchase Manager Dashboard -->
    <div class="admin-dashboard purchase-dashboard" id="purchaseDashboard">
        <div class="dashboard-header">
            <div class="container dashboard-title">
                <h1><i class="fas fa-shopping-cart"></i> Responsável de Compras - MAFC</h1>
                <button class="logout-btn" id="purchaseLogoutBtn"><i class="fas fa-sign-out-alt"></i> Sair</button>
            </div>
        </div>
        <div class="dashboard-content">
            <div class="purchase-header">
                <h2>Gestão de Compras - Todas as Equipas Alemanha</h2>
                <p>Aprovação de pedidos e gestão de fornecedores</p>
            </div>
            
            <div class="form-section">
                <h3><i class="fas fa-clipboard-list"></i> Pedidos Pendentes de Aprovação</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Equipa</th>
                            <th>Material</th>
                            <th>Quantidade</th>
                            <th>Urgência</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody id="pendingRequestsTable">
                        <!-- Pending requests will be loaded here -->
                    </tbody>
                </table>
            </div>
            
            <div class="form-section">
                <h3><i class="fas fa-check-circle"></i> Compras Aprovadas</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Nº Encomenda</th>
                            <th>Fornecedor</th>
                            <th>Material</th>
                            <th>Valor</th>
                            <th>Data Entrega</th>
                            <th>Estado</th>
                        </tr>
                    </thead>
                    <tbody id="approvedPurchasesTable">
                        <!-- Approved purchases will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // ============== SISTEMA COMPLETO MAFC TEAM CONTROL ==============
        
        // Database simulation
        const systemData = {
            // Credentials for testing
            users: [
                { username: 'mafc', password: '1234', role: 'admin', name: 'Administrador' },
                { username: 'equipa01', password: '1234', role: 'team', name: 'João Silva', team: 'Equipa 01 - Berlin' },
                { username: 'compras', password: '1234', role: 'purchase', name: 'Responsável Compras' }
            ],
            
            // 15 Teams working in Germany
            teams: [
                { id: 1, name: 'Equipa 01 - Berlin', leader: 'João Silva', location: 'Berlim, Kreuzberg', workers: 5, status: 'working' },
                { id: 2, name: 'Equipa 02 - Hamburg', leader: 'Carlos Mendes', location: 'Hamburgo, Centro', workers: 3, status: 'working' },
                { id: 3, name: 'Equipa 03 - Munich', leader: 'Miguel Santos', location: 'Munique, Subúrbios', workers: 4, status: 'working' },
                { id: 4, name: 'Equipa 04 - Cologne', leader: 'António Oliveira', location: 'Colónia', workers: 4, status: 'working' },
                { id: 5, name: 'Equipa 05 - Frankfurt', leader: 'Pedro Costa', location: 'Frankfurt', workers: 3, status: 'working' }
            ],
            
            // Construction materials database
            materials: [
                // Construction Materials
                { id: 1, name: 'Cimento', category: 'materials', unit: 'sacos' },
                { id: 2, name: 'Areia', category: 'materials', unit: 'm3' },
                { id: 3, name: 'Brita', category: 'materials', unit: 'm3' },
                { id: 4, name: 'Alcatrão', category: 'materials', unit: 'ton' },
                { id: 5, name: 'Tijolos', category: 'materials', unit: 'unidades' },
                { id: 6, name: 'Tubos PVC', category: 'materials', unit: 'unidades' },
                { id: 7, name: 'Aço', category: 'materials', unit: 'kg' },
                { id: 8, name: 'Madeira', category: 'materials', unit: 'm3' },
                
                // Machines and Equipment
                { id: 9, name: 'Retroescavadora', category: 'machines', unit: 'horas' },
                { id: 10, name: 'Camião Basculante', category: 'machines', unit: 'dias' },
                { id: 11, name: 'Betoneira', category: 'machines', unit: 'dias' },
                { id: 12, name: 'Compactador', category: 'machines', unit: 'horas' },
                { id: 13, name: 'Grua', category: 'machines', unit: 'dias' },
                { id: 14, name: 'Escavadora', category: 'machines', unit: 'horas' },
                
                // Tools
                { id: 15, name: 'Martelo Pneumático', category: 'tools', unit: 'unidades' },
                { id: 16, name: 'Cortadora de Pavimento', category: 'tools', unit: 'unidades' },
                { id: 17, name: 'Betoneira Portátil', category: 'tools', unit: 'unidades' },
                { id: 18, name: 'Furadeira de Concreto', category: 'tools', unit: 'unidades' },
                
                // Vehicles
                { id: 19, name: 'Camião 10T', category: 'vehicles', unit: 'dias' },
                { id: 20, name: 'Viatura Ligeira', category: 'vehicles', unit: 'dias' },
                { id: 21, name: 'Carro de Mistura', category: 'vehicles', unit: 'horas' },
                
                // Consumables
                { id: 22, name: 'Gasóleo', category: 'consumables', unit: 'litros' },
                { id: 23, name: 'Óleo Motor', category: 'consumables', unit: 'litros' },
                { id: 24, name: 'Luvas de Trabalho', category: 'consumables', unit: 'pares' },
                { id: 25, name: 'Capacetes', category: 'consumables', unit: 'unidades' },
                { id: 26, name: 'Óculos Proteção', category: 'consumables', unit: 'unidades' }
            ],
            
            // Material requests from teams
            materialRequests: [
                { id: 1, team: 'Equipa 01 - Berlin', material: 'Cimento', quantity: 50, unit: 'sacos', date: '09/12/2024', status: 'pending' },
                { id: 2, team: 'Equipa 02 - Hamburg', material: 'Alcatrão', quantity: 2, unit: 'ton', date: '08/12/2024', status: 'pending' },
                { id: 3, team: 'Equipa 03 - Munich', material: 'Retroescavadora', quantity: 1, unit: 'horas', date: '10/12/2024', status: 'pending' }
            ],
            
            // Time records
            timeRecords: [
                { worker: 'João Silva', date: '10/12/2024', start: '08:00', end: '12:30', total: 4.5 }
            ]
        };
        
        // Current user
        let currentUser = null;
        
        // ============== LOGIN SYSTEM ==============
        const loginModal = document.getElementById('loginModal');
        const openLoginBtn = document.getElementById('openLogin');
        const closeModalBtn = document.querySelector('.close-modal');
        const loginForm = document.getElementById('loginForm');
        
        // Open modal
        openLoginBtn.addEventListener('click', (e) => {
            e.preventDefault();
            loginModal.style.display = 'flex';
        });
        
        // Close modal
        closeModalBtn.addEventListener('click', () => {
            loginModal.style.display = 'none';
        });
        
        // Close modal when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target === loginModal) {
                loginModal.style.display = 'none';
            }
        });
        
        // Login form submission
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const role = document.getElementById('role').value;
            
            // Find user
            const user = systemData.users.find(u => 
                u.username === username && 
                u.password === password && 
                u.role === role
            );
            
            if (user) {
                currentUser = user;
                loginModal.style.display = 'none';
                
                // Hide public website
                document.getElementById('publicWebsite').style.display = 'none';
                
                // Show appropriate dashboard
                if (role === 'admin') {
                    showAdminDashboard();
                } else if (role === 'team') {
                    showTeamDashboard();
                } else if (role === 'purchase') {
                    showPurchaseDashboard();
                }
                
                // Initialize dashboard data
                initializeDashboardData();
                
            } else {
                alert('Credenciais incorretas! Utilize: mafc / 1234');
            }
        });
        
        // ============== DASHBOARD FUNCTIONS ==============
        function showAdminDashboard() {
            document.getElementById('adminDashboard').style.display = 'block';
        }
        
        function showTeamDashboard() {
            document.getElementById('teamDashboard').style.display = 'block';
        }
        
        function showPurchaseDashboard() {
            document.getElementById('purchaseDashboard').style.display = 'block';
        }
        
        function initializeDashboardData() {
            // Update current date
            updateDateTime();
            
            // Load teams data for admin
            loadTeamsTable();
            
            // Load materials data for admin
            loadMaterialsTable();
            
            // Load overtime data
            loadOvertimeData();
            
            // Load materials for team leader
            loadMaterialsForTeam();
            
            // Load time records for team leader
            loadTimeRecords();
            
            // Load pending requests for purchase manager
            loadPendingRequests();
            
            // Load approved purchases for purchase manager
            loadApprovedPurchases();
        }
        
        function loadTeamsTable() {
            const table = document.getElementById('teamsTable');
            table.innerHTML = '';
            
            systemData.teams.forEach(team => {
                const row = `
                    <tr>
                        <td>#${team.id.toString().padStart(3, '0')}</td>
                        <td>${team.name}</td>
                        <td>${team.leader}</td>
                        <td>${team.location}</td>
                        <td>Saneamento Urbano</td>
                        <td>52.5200° N, 13.4050° E</td>
                        <td>
                            <button class="btn btn-primary" onclick="viewTeamDetails(${team.id})">Ver</button>
                            <button class="btn btn-warning" onclick="editTeam(${team.id})">Editar</button>
                        </td>
                    </tr>
                `;
                table.innerHTML += row;
            });
        }
        
        function loadMaterialsTable() {
            const table = document.getElementById('materialsTable');
            table.innerHTML = '';
            
            systemData.materialRequests.forEach(request => {
                const statusBadge = request.status === 'pending' ? 
                    '<span class="status-badge status-pending">Pendente</span>' : 
                    '<span class="status-badge status-approved">Aprovado</span>';
                
                const row = `
                    <tr>
                        <td>#MAT-${request.id.toString().padStart(3, '0')}</td>
                        <td>${request.material}</td>
                        <td>${request.quantity} ${request.unit}</td>
                        <td>${request.team}</td>
                        <td>${request.date}</td>
                        <td>${statusBadge}</td>
                        <td>
                            <button class="btn btn-success" onclick="approveMaterial(${request.id})">Aprovar</button>
                            <button class="btn btn-danger" onclick="rejectMaterial(${request.id})">Recusar</button>
                        </td>
                    </tr>
                `;
                table.innerHTML += row;
            });
        }
        
        function loadOvertimeData() {
            const table = document.getElementById('overtimeTable');
            table.innerHTML = `
                <tr>
                    <td>João Silva</td>
                    <td>Equipa 01 - Berlin</td>
                    <td>160</td>
                    <td>12</td>
                    <td>172</td>
                    <td>12h</td>
                </tr>
                <tr>
                    <td>Carlos Mendes</td>
                    <td>Equipa 02 - Hamburg</td>
                    <td>160</td>
                    <td>8</td>
                    <td>168</td>
                    <td>8h</td>
                </tr>
                <tr>
                    <td>Miguel Santos</td>
                    <td>Equipa 03 - Munich</td>
                    <td>160</td>
                    <td>15</td>
                    <td>175</td>
                    <td>15h</td>
                </tr>
            `;
        }
        
        function loadMaterialsForTeam() {
            const select = document.getElementById('materialSelect');
            select.innerHTML = '';
            
            systemData.materials.forEach(material => {
                const option = document.createElement('option');
                option.value = material.id;
                option.textContent = `${material.name} (${material.unit})`;
                select.appendChild(option);
            });
        }
        
        function loadTimeRecords() {
            const table = document.getElementById('timeRecordsTable');
            table.innerHTML = '';
            
            systemData.timeRecords.forEach(record => {
                const overtime = record.total > 8 ? record.total - 8 : 0;
                const row = `
                    <tr>
                        <td>${record.worker}</td>
                        <td>${record.start}</td>
                        <td>${record.end || '--:--'}</td>
                        <td>${record.total}h</td>
                        <td>${overtime > 0 ? `<span class="status-badge status-overtime">+${overtime}h</span>` : '0h'}</td>
                    </tr>
                `;
                table.innerHTML += row;
            });
        }
        
        function loadPendingRequests() {
            const table = document.getElementById('pendingRequestsTable');
            table.innerHTML = '';
            
            const pendingRequests = systemData.materialRequests.filter(r => r.status === 'pending');
            
            pendingRequests.forEach(request => {
                const row = `
                    <tr>
                        <td>${request.date}</td>
                        <td>${request.team}</td>
                        <td>${request.material}</td>
                        <td>${request.quantity} ${request.unit}</td>
                        <td><span class="status-badge status-pending">${request.urgency || 'Normal'}</span></td>
                        <td>
                            <button class="btn btn-success" onclick="approveRequest(${request.id})">Aprovar</button>
                            <button class="btn btn-danger" onclick="rejectRequest(${request.id})">Recusar</button>
                        </td>
                    </tr>
                `;
                table.innerHTML += row;
            });
        }
        
        function loadApprovedPurchases() {
            const table = document.getElementById('approvedPurchasesTable');
            table.innerHTML = `
                <tr>
                    <td>#ENCM-001</td>
                    <td>Fornecedor A</td>
                    <td>Cimento</td>
                    <td>1.250€</td>
                    <td>15/12/2024</td>
                    <td><span class="status-badge status-approved">Encomendado</span></td>
                </tr>
                <tr>
                    <td>#ENCM-002</td>
                    <td>Fornecedor B</td>
                    <td>Alcatrão</td>
                    <td>3.500€</td>
                    <td>12/12/2024</td>
                    <td><span class="status-badge status-approved">Entregue</span></td>
                </tr>
            `;
        }
        
        // ============== TEAM LEADER FUNCTIONS ==============
        function openSection(section) {
            // Hide all sections
            document.querySelectorAll('#teamDashboard .dashboard-section').forEach(s => {
                s.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(`${section}Section`).classList.add('active');
        }
        
        function registerTime() {
            const workerSelect = document.getElementById('workerSelect');
            const timeAction = document.getElementById('timeAction');
            const currentTime = document.getElementById('currentTime');
            
            const worker = workerSelect.options[workerSelect.selectedIndex].text;
            const action = timeAction.value;
            const time = currentTime.value;
            
            if (action === 'start') {
                // Add new time record
                systemData.timeRecords.push({
                    worker: worker.split(' (')[0],
                    date: new Date().toLocaleDateString('pt-PT'),
                    start: time,
                    end: null,
                    total: 0
                });
                
                alert(`✅ Entrada registada para ${worker} às ${time}`);
            } else {
                // Find and update time record
                const record = systemData.timeRecords.find(r => 
                    r.worker === worker.split(' (')[0] && 
                    r.date === new Date().toLocaleDateString('pt-PT')
                );
                
                if (record) {
                    record.end = time;
                    
                    // Calculate total hours
                    const startTime = record.start.split(':');
                    const endTime = time.split(':');
                    const startDate = new Date(0, 0, 0, startTime[0], startTime[1]);
                    const endDate = new Date(0, 0, 0, endTime[0], endTime[1]);
                    const diff = (endDate - startDate) / (1000 * 60 * 60);
                    record.total = diff.toFixed(1);
                    
                    // Check for overtime (> 8 hours)
                    if (diff > 8) {
                        const overtime = diff - 8;
                        alert(`✅ Saída registada para ${worker} às ${time}\n⏰ Total: ${record.total}h\n⚠️ Horas Extra: ${overtime.toFixed(1)}h`);
                    } else {
                        alert(`✅ Saída registada para ${worker} às ${time}\n⏰ Total: ${record.total}h`);
                    }
                }
            }
            
            // Update time records table
            loadTimeRecords();
        }
        
        function registerAll(action) {
            const workers = ['João Silva', 'Carlos Mendes', 'Miguel Santos', 'António Oliveira', 'Pedro Costa'];
            const currentTime = document.getElementById('currentTime').value;
            
            if (action === 'start') {
                workers.forEach(worker => {
                    // Check if already registered
                    const existing = systemData.timeRecords.find(r => 
                        r.worker === worker && 
                        r.date === new Date().toLocaleDateString('pt-PT')
                    );
                    
                    if (!existing) {
                        systemData.timeRecords.push({
                            worker: worker,
                            date: new Date().toLocaleDateString('pt-PT'),
                            start: currentTime,
                            end: null,
                            total: 0
                        });
                    }
                });
                
                alert(`✅ Entrada registada para TODA A EQUIPA às ${currentTime}`);
            } else {
                workers.forEach(worker => {
                    const record = systemData.timeRecords.find(r => 
                        r.worker === worker && 
                        r.date === new Date().toLocaleDateString('pt-PT')
                    );
                    
                    if (record && !record.end) {
                        record.end = currentTime;
                        
                        // Calculate total hours
                        const startTime = record.start.split(':');
                        const endTime = currentTime.split(':');
                        const startDate = new Date(0, 0, 0, startTime[0], startTime[1]);
                        const endDate = new Date(0, 0, 0, endTime[0], endTime[1]);
                        const diff = (endDate - startDate) / (1000 * 60 * 60);
                        record.total = diff.toFixed(1);
                    }
                });
                
                alert(`✅ Saída registada para TODA A EQUIPA às ${currentTime}`);
            }
            
            loadTimeRecords();
        }
        
        function filterMaterials() {
            const category = document.getElementById('materialCategory').value;
            const select = document.getElementById('materialSelect');
            select.innerHTML = '';
            
            const filteredMaterials = category === 'all' ? 
                systemData.materials : 
                systemData.materials.filter(m => m.category === category);
            
            filteredMaterials.forEach(material => {
                const option = document.createElement('option');
                option.value = material.id;
                option.textContent = `${material.name} (${material.unit})`;
                select.appendChild(option);
            });
        }
        
        function submitMaterialRequest() {
            const category = document.getElementById('materialCategory').value;
            const materialSelect = document.getElementById('materialSelect');
            const materialId = materialSelect.value;
            const material = materialSelect.options[materialSelect.selectedIndex].text.split(' (')[0];
            const quantity = document.getElementById('materialQuantity').value;
            const unit = document.getElementById('materialUnit').value;
            const urgency = document.getElementById('materialUrgency').value;
            const notes = document.getElementById('materialNotes').value;
            
            if (!material || !quantity) {
                alert('Por favor, selecione um material e quantidade!');
                return;
            }
            
            // Add to material requests
            const newRequest = {
                id: systemData.materialRequests.length + 1,
                team: currentUser.team,
                material: material,
                quantity: parseInt(quantity),
                unit: unit,
                urgency: urgency,
                notes: notes,
                date: new Date().toLocaleDateString('pt-PT'),
                status: 'pending'
            };
            
            systemData.materialRequests.push(newRequest);
            
            // Update counts
            const materialsCount = document.getElementById('teamMaterials');
            materialsCount.textContent = parseInt(materialsCount.textContent) + 1;
            
            // Update tables
            if (currentUser.role === 'admin') {
                loadMaterialsTable();
            } else if (currentUser.role === 'purchase') {
                loadPendingRequests();
            }
            
            alert(`✅ Pedido de material enviado para o Responsável de Compras!\n\nMaterial: ${material}\nQuantidade: ${quantity} ${unit}\nUrgência: ${urgency}`);
            
            // Reset form
            document.getElementById('materialQuantity').value = 1;
            document.getElementById('materialNotes').value = '';
        }
        
        function addCustomMaterial() {
            const materialName = prompt('Nome do material personalizado:');
            if (!materialName) return;
            
            const unit = prompt('Unidade de medida (kg, unidades, litros, etc.):');
            if (!unit) return;
            
            // Add to materials list
            const newMaterial = {
                id: systemData.materials.length + 1,
                name: materialName,
                category: 'other',
                unit: unit
            };
            
            systemData.materials.push(newMaterial);
            
            // Update select
            const select = document.getElementById('materialSelect');
            const option = document.createElement('option');
            option.value = newMaterial.id;
            option.textContent = `${newMaterial.name} (${newMaterial.unit})`;
            select.appendChild(option);
            
            alert(`✅ Material "${materialName}" adicionado com sucesso!`);
        }
        
        // ============== PURCHASE MANAGER FUNCTIONS ==============
        function approveRequest(requestId) {
            const request = systemData.materialRequests.find(r => r.id === requestId);
            if (request) {
                request.status = 'approved';
                
                // Ask for purchase details
                const supplier = prompt('Nome do fornecedor:');
                const orderNumber = prompt('Número da encomenda:');
                const deliveryDate = prompt('Data de entrega (DD/MM/AAAA):');
                
                if (supplier && orderNumber && deliveryDate) {
                    alert(`✅ Pedido aprovado!\nFornecedor: ${supplier}\nEncomenda: ${orderNumber}\nEntrega: ${deliveryDate}`);
                    
                    // Update tables
                    loadPendingRequests();
                }
            }
        }
        
        function rejectRequest(requestId) {
            const reason = prompt('Motivo da recusa:');
            if (reason) {
                const request = systemData.materialRequests.find(r => r.id === requestId);
                if (request) {
                    request.status = 'rejected';
                    alert(`❌ Pedido recusado!\nMotivo: ${reason}`);
                    loadPendingRequests();
                }
            }
        }
        
        // ============== ADMIN FUNCTIONS ==============
        function viewTeamDetails(teamId) {
            const team = systemData.teams.find(t => t.id === teamId);
            if (team) {
                alert(`Equipa: ${team.name}\nChefe: ${team.leader}\nLocalização: ${team.location}\nTrabalhadores: ${team.workers}\nEstado: ${team.status}`);
            }
        }
        
        function approveMaterial(requestId) {
            const request = systemData.materialRequests.find(r => r.id === requestId);
            if (request) {
                request.status = 'approved';
                alert(`✅ Pedido de material aprovado!\nEquipa: ${request.team}\nMaterial: ${request.material}`);
                loadMaterialsTable();
            }
        }
        
        function rejectMaterial(requestId) {
            const reason = prompt('Motivo da recusa:');
            if (reason) {
                const request = systemData.materialRequests.find(r => r.id === requestId);
                if (request) {
                    request.status = 'rejected';
                    alert(`❌ Pedido recusado!\nMotivo: ${reason}`);
                    loadMaterialsTable();
                }
            }
        }
        
        function exportToAccounting() {
            // Simulate export to accounting system
            const data = {
                overtime: systemData.timeRecords.filter(r => r.total > 8),
                purchases: systemData.materialRequests.filter(r => r.status === 'approved'),
                date: new Date().toLocaleDateString('pt-PT')
            };
            
            // Create downloadable file
            const content = `Relatório Contabilidade MAFC - ${data.date}\n\n` +
                          `BANCO DE HORAS (>160h/mês):\n` +
                          data.overtime.map(r => `- ${r.worker}: ${r.total}h (${r.total-8}h extra)`).join('\n') +
                          `\n\nCOMPRAS APROVADAS:\n` +
                          data.purchases.map(p => `- ${p.material}: ${p.quantity} ${p.unit} - ${p.team}`).join('\n');
            
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `contabilidade_mafc_${data.date.replace(/\//g, '-')}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('✅ Relatório exportado para contabilidade com sucesso!');
        }
        
        // ============== UTILITY FUNCTIONS ==============
        function updateDateTime() {
            const now = new Date();
            const options = { 
                day: '2-digit', 
                month: '2-digit', 
                year: 'numeric',
                hour: '2-digit', 
                minute: '2-digit'
            };
            
            // Update current time for team dashboard
            const timeElement = document.getElementById('currentTime');
            if (timeElement) {
                timeElement.value = now.toLocaleTimeString('pt-PT', { hour: '2-digit', minute: '2-digit' });
            }
            
            // Update date displays
            document.querySelectorAll('#currentDate').forEach(el => {
                el.textContent = now.toLocaleDateString('pt-PT', options);
            });
        }
        
        // Update time every minute
        setInterval(updateDateTime, 60000);
        
        // Initialize
        updateDateTime();
        
        // Category tags
        document.querySelectorAll('.category-tag').forEach(tag => {
            tag.addEventListener('click', function() {
                document.querySelectorAll('.category-tag').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                const category = this.getAttribute('data-category');
                if (category === 'all') {
                    filterMaterials();
                }
            });
        });
        
        // Sidebar navigation for admin
        document.querySelectorAll('.sidebar-menu a').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Remove active class from all links
                document.querySelectorAll('.sidebar-menu a').forEach(l => l.classList.remove('active'));
                // Add active class to clicked link
                this.classList.add('active');
                
                // Get target section
                const targetSection = this.getAttribute('data-section');
                
                // Hide all sections
                document.querySelectorAll('#adminDashboard .dashboard-section').forEach(section => {
                    section.classList.remove('active');
                });
                
                // Show target section
                document.getElementById(targetSection + 'Section').classList.add('active');
            });
        });
        
        // Logout functionality
        document.querySelectorAll('.logout-btn, #teamLogoutBtn, #purchaseLogoutBtn').forEach(btn => {
            btn.addEventListener('click', function() {
                if (confirm('Tem certeza que deseja sair do sistema?')) {
                    // Hide all dashboards
                    document.getElementById('adminDashboard').style.display = 'none';
                    document.getElementById('teamDashboard').style.display = 'none';
                    document.getElementById('purchaseDashboard').style.display = 'none';
                    
                    // Show public website
                    document.getElementById('publicWebsite').style.display = 'block';
                    
                    // Reset login form
                    loginForm.reset();
                    currentUser = null;
                }
            });
        });
        
        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                if(this.getAttribute('href') === '#') return;
                
                e.preventDefault();
                
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                
                if(targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop - 80,
                        behavior: 'smooth'
                    });
                }
            });
        });
    </script>
</body>
</html>
